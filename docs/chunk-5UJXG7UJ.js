import{a as Kt}from"./chunk-TJGNGVF5.js";import{a as De,b as Dt,d as W,e as L}from"./chunk-36WC3TMA.js";import{e as Bt,h as ft}from"./chunk-YXX6ZOWB.js";import{i as Pt,k as Pe,o as St,q as at}from"./chunk-K73A3GOM.js";import{D as Ht,F as tt,G as Zt,H as Qt,J as ke,K as ve,W as U,Z as Jt,q as Me,y as wt}from"./chunk-ZOBOIQH4.js";import{b as k,d as Q,j as K}from"./chunk-GKVXYTML.js";import{a as st,b as lt,m as C}from"./chunk-A3ZZXC42.js";function Ut(o,t,r){if(o&&o.length){let[s,e]=t,n=Math.PI/180*r,h=Math.cos(n),a=Math.sin(n);for(let c of o){let[i,l]=c;c[0]=(i-s)*h-(l-e)*a+s,c[1]=(i-s)*a+(l-e)*h+e}}}function oa(o,t){return o[0]===t[0]&&o[1]===t[1]}function ha(o,t,r,s=1){let e=r,n=Math.max(t,.1),h=o[0]&&o[0][0]&&typeof o[0][0]=="number"?[o]:o,a=[0,0];if(e)for(let i of h)Ut(i,a,e);let c=(function(i,l,g){let f=[];for(let x of i){let b=[...x];oa(b[0],b[b.length-1])||b.push([b[0][0],b[0][1]]),b.length>2&&f.push(b)}let p=[];l=Math.max(l,.1);let u=[];for(let x of f)for(let b=0;b<x.length-1;b++){let w=x[b],$=x[b+1];if(w[1]!==$[1]){let M=Math.min(w[1],$[1]);u.push({ymin:M,ymax:Math.max(w[1],$[1]),x:M===w[1]?w[0]:$[0],islope:($[0]-w[0])/($[1]-w[1])})}}if(u.sort((x,b)=>x.ymin<b.ymin?-1:x.ymin>b.ymin?1:x.x<b.x?-1:x.x>b.x?1:x.ymax===b.ymax?0:(x.ymax-b.ymax)/Math.abs(x.ymax-b.ymax)),!u.length)return p;let y=[],m=u[0].ymin,d=0;for(;y.length||u.length;){if(u.length){let x=-1;for(let b=0;b<u.length&&!(u[b].ymin>m);b++)x=b;u.splice(0,x+1).forEach(b=>{y.push({s:m,edge:b})})}if(y=y.filter(x=>!(x.edge.ymax<=m)),y.sort((x,b)=>x.edge.x===b.edge.x?0:(x.edge.x-b.edge.x)/Math.abs(x.edge.x-b.edge.x)),(g!==1||d%l==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let b=x+1;if(b>=y.length)break;let w=y[x].edge,$=y[b].edge;p.push([[Math.round(w.x),m],[Math.round($.x),m]])}m+=g,y.forEach(x=>{x.edge.x=x.edge.x+g*x.edge.islope}),d++}return p})(h,n,s);if(e){for(let i of h)Ut(i,a,-e);(function(i,l,g){let f=[];i.forEach(p=>f.push(...p)),Ut(f,l,g)})(c,a,-e)}return c}function At(o,t){var r;let s=t.hachureAngle+90,e=t.hachureGap;e<0&&(e=4*t.strokeWidth),e=Math.round(Math.max(e,.1));let n=1;return t.roughness>=1&&(((r=t.randomizer)===null||r===void 0?void 0:r.next())||Math.random())>.7&&(n=e),ha(o,e,s,n||1)}var Rt=class{constructor(t){this.helper=t}fillPolygons(t,r){return this._fillPolygons(t,r)}_fillPolygons(t,r){let s=At(t,r);return{type:"fillSketch",ops:this.renderLines(s,r)}}renderLines(t,r){let s=[];for(let e of t)s.push(...this.helper.doubleLineOps(e[0][0],e[0][1],e[1][0],e[1][1],r));return s}};function Ft(o){let t=o[0],r=o[1];return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))}var re=class extends Rt{fillPolygons(t,r){let s=r.hachureGap;s<0&&(s=4*r.strokeWidth),s=Math.max(s,.1);let e=At(t,Object.assign({},r,{hachureGap:s})),n=Math.PI/180*r.hachureAngle,h=[],a=.5*s*Math.cos(n),c=.5*s*Math.sin(n);for(let[i,l]of e)Ft([i,l])&&h.push([[i[0]-a,i[1]+c],[...l]],[[i[0]+a,i[1]-c],[...l]]);return{type:"fillSketch",ops:this.renderLines(h,r)}}},ne=class extends Rt{fillPolygons(t,r){let s=this._fillPolygons(t,r),e=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),n=this._fillPolygons(t,e);return s.ops=s.ops.concat(n.ops),s}},ie=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=At(t,r=Object.assign({},r,{hachureAngle:0}));return this.dotsOnLines(s,r)}dotsOnLines(t,r){let s=[],e=r.hachureGap;e<0&&(e=4*r.strokeWidth),e=Math.max(e,.1);let n=r.fillWeight;n<0&&(n=r.strokeWidth/2);let h=e/4;for(let a of t){let c=Ft(a),i=c/e,l=Math.ceil(i)-1,g=c-l*e,f=(a[0][0]+a[1][0])/2-e/4,p=Math.min(a[0][1],a[1][1]);for(let u=0;u<l;u++){let y=p+g+u*e,m=f-h+2*Math.random()*h,d=y-h+2*Math.random()*h,x=this.helper.ellipse(m,d,n,n,r);s.push(...x.ops)}}return{type:"fillSketch",ops:s}}},le=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=At(t,r);return{type:"fillSketch",ops:this.dashedLine(s,r)}}dashedLine(t,r){let s=r.dashOffset<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashOffset,e=r.dashGap<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashGap,n=[];return t.forEach(h=>{let a=Ft(h),c=Math.floor(a/(s+e)),i=(a+e-c*(s+e))/2,l=h[0],g=h[1];l[0]>g[0]&&(l=h[1],g=h[0]);let f=Math.atan((g[1]-l[1])/(g[0]-l[0]));for(let p=0;p<c;p++){let u=p*(s+e),y=u+s,m=[l[0]+u*Math.cos(f)+i*Math.cos(f),l[1]+u*Math.sin(f)+i*Math.sin(f)],d=[l[0]+y*Math.cos(f)+i*Math.cos(f),l[1]+y*Math.sin(f)+i*Math.sin(f)];n.push(...this.helper.doubleLineOps(m[0],m[1],d[0],d[1],r))}}),n}},ce=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,e=r.zigzagOffset<0?s:r.zigzagOffset,n=At(t,r=Object.assign({},r,{hachureGap:s+e}));return{type:"fillSketch",ops:this.zigzagLines(n,e,r)}}zigzagLines(t,r,s){let e=[];return t.forEach(n=>{let h=Ft(n),a=Math.round(h/(2*r)),c=n[0],i=n[1];c[0]>i[0]&&(c=n[1],i=n[0]);let l=Math.atan((i[1]-c[1])/(i[0]-c[0]));for(let g=0;g<a;g++){let f=2*g*r,p=2*(g+1)*r,u=Math.sqrt(2*Math.pow(r,2)),y=[c[0]+f*Math.cos(l),c[1]+f*Math.sin(l)],m=[c[0]+p*Math.cos(l),c[1]+p*Math.sin(l)],d=[y[0]+u*Math.cos(l+Math.PI/4),y[1]+u*Math.sin(l+Math.PI/4)];e.push(...this.helper.doubleLineOps(y[0],y[1],d[0],d[1],s),...this.helper.doubleLineOps(d[0],d[1],m[0],m[1],s))}}),e}},nt={},oe=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},ga=0,te=1,Be=2,It={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ee(o,t){return o.type===t}function ye(o){let t=[],r=(function(h){let a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:ga,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:te,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:Be,text:""},a})(o),s="BOD",e=0,n=r[e];for(;!ee(n,Be);){let h=0,a=[];if(s==="BOD"){if(n.text!=="M"&&n.text!=="m")return ye("M0,0"+o);e++,h=It[n.text],s=n.text}else ee(n,te)?h=It[s]:(e++,h=It[n.text],s=n.text);if(!(e+h<r.length))throw new Error("Path data ended short");for(let c=e;c<e+h;c++){let i=r[c];if(!ee(i,te))throw new Error("Param not a number: "+s+","+i.text);a[a.length]=+i.text}if(typeof It[s]!="number")throw new Error("Bad segment: "+s);{let c={key:s,data:a};t.push(c),e+=h,n=r[e],s==="M"&&(s="L"),s==="m"&&(s="l")}}return t}function He(o){let t=0,r=0,s=0,e=0,n=[];for(let{key:h,data:a}of o)switch(h){case"M":n.push({key:"M",data:[...a]}),[t,r]=a,[s,e]=a;break;case"m":t+=a[0],r+=a[1],n.push({key:"M",data:[t,r]}),s=t,e=r;break;case"L":n.push({key:"L",data:[...a]}),[t,r]=a;break;case"l":t+=a[0],r+=a[1],n.push({key:"L",data:[t,r]});break;case"C":n.push({key:"C",data:[...a]}),t=a[4],r=a[5];break;case"c":{let c=a.map((i,l)=>l%2?i+r:i+t);n.push({key:"C",data:c}),t=c[4],r=c[5];break}case"Q":n.push({key:"Q",data:[...a]}),t=a[2],r=a[3];break;case"q":{let c=a.map((i,l)=>l%2?i+r:i+t);n.push({key:"Q",data:c}),t=c[2],r=c[3];break}case"A":n.push({key:"A",data:[...a]}),t=a[5],r=a[6];break;case"a":t+=a[5],r+=a[6],n.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,r]});break;case"H":n.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],n.push({key:"H",data:[t]});break;case"V":n.push({key:"V",data:[...a]}),r=a[0];break;case"v":r+=a[0],n.push({key:"V",data:[r]});break;case"S":n.push({key:"S",data:[...a]}),t=a[2],r=a[3];break;case"s":{let c=a.map((i,l)=>l%2?i+r:i+t);n.push({key:"S",data:c}),t=c[2],r=c[3];break}case"T":n.push({key:"T",data:[...a]}),t=a[0],r=a[1];break;case"t":t+=a[0],r+=a[1],n.push({key:"T",data:[t,r]});break;case"Z":case"z":n.push({key:"Z",data:[]}),t=s,r=e}return n}function Ie(o){let t=[],r="",s=0,e=0,n=0,h=0,a=0,c=0;for(let{key:i,data:l}of o){switch(i){case"M":t.push({key:"M",data:[...l]}),[s,e]=l,[n,h]=l;break;case"C":t.push({key:"C",data:[...l]}),s=l[4],e=l[5],a=l[2],c=l[3];break;case"L":t.push({key:"L",data:[...l]}),[s,e]=l;break;case"H":s=l[0],t.push({key:"L",data:[s,e]});break;case"V":e=l[0],t.push({key:"L",data:[s,e]});break;case"S":{let g=0,f=0;r==="C"||r==="S"?(g=s+(s-a),f=e+(e-c)):(g=s,f=e),t.push({key:"C",data:[g,f,...l]}),a=l[0],c=l[1],s=l[2],e=l[3];break}case"T":{let[g,f]=l,p=0,u=0;r==="Q"||r==="T"?(p=s+(s-a),u=e+(e-c)):(p=s,u=e);let y=s+2*(p-s)/3,m=e+2*(u-e)/3,d=g+2*(p-g)/3,x=f+2*(u-f)/3;t.push({key:"C",data:[y,m,d,x,g,f]}),a=p,c=u,s=g,e=f;break}case"Q":{let[g,f,p,u]=l,y=s+2*(g-s)/3,m=e+2*(f-e)/3,d=p+2*(g-p)/3,x=u+2*(f-u)/3;t.push({key:"C",data:[y,m,d,x,p,u]}),a=g,c=f,s=p,e=u;break}case"A":{let g=Math.abs(l[0]),f=Math.abs(l[1]),p=l[2],u=l[3],y=l[4],m=l[5],d=l[6];g===0||f===0?(t.push({key:"C",data:[s,e,m,d,m,d]}),s=m,e=d):(s!==m||e!==d)&&(Ee(s,e,m,d,g,f,p,u,y).forEach(function(x){t.push({key:"C",data:x})}),s=m,e=d);break}case"Z":t.push({key:"Z",data:[]}),s=n,e=h}r=i}return t}function Ct(o,t,r){return[o*Math.cos(r)-t*Math.sin(r),o*Math.sin(r)+t*Math.cos(r)]}function Ee(o,t,r,s,e,n,h,a,c,i){let l=(g=h,Math.PI*g/180);var g;let f=[],p=0,u=0,y=0,m=0;if(i)[p,u,y,m]=i;else{[o,t]=Ct(o,t,-l),[r,s]=Ct(r,s,-l);let E=(o-r)/2,B=(t-s)/2,I=E*E/(e*e)+B*B/(n*n);I>1&&(I=Math.sqrt(I),e*=I,n*=I);let A=e*e,X=n*n,j=A*X-A*B*B-X*E*E,H=A*B*B+X*E*E,F=(a===c?-1:1)*Math.sqrt(Math.abs(j/H));y=F*e*B/n+(o+r)/2,m=F*-n*E/e+(t+s)/2,p=Math.asin(parseFloat(((t-m)/n).toFixed(9))),u=Math.asin(parseFloat(((s-m)/n).toFixed(9))),o<y&&(p=Math.PI-p),r<y&&(u=Math.PI-u),p<0&&(p=2*Math.PI+p),u<0&&(u=2*Math.PI+u),c&&p>u&&(p-=2*Math.PI),!c&&u>p&&(u-=2*Math.PI)}let d=u-p;if(Math.abs(d)>120*Math.PI/180){let E=u,B=r,I=s;u=c&&u>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=Ee(r=y+e*Math.cos(u),s=m+n*Math.sin(u),B,I,e,n,h,0,c,[u,E,y,m])}d=u-p;let x=Math.cos(p),b=Math.sin(p),w=Math.cos(u),$=Math.sin(u),M=Math.tan(d/4),D=4/3*e*M,v=4/3*n*M,P=[o,t],R=[o+D*b,t-v*x],O=[r+D*$,s-v*w],V=[r,s];if(R[0]=2*P[0]-R[0],R[1]=2*P[1]-R[1],i)return[R,O,V].concat(f);{f=[R,O,V].concat(f);let E=[];for(let B=0;B<f.length;B+=3){let I=Ct(f[B][0],f[B][1],l),A=Ct(f[B+1][0],f[B+1][1],l),X=Ct(f[B+2][0],f[B+2][1],l);E.push([I[0],I[1],A[0],A[1],X[0],X[1]])}return E}}var pa={randOffset:function(o,t){return G(o,t)},randOffsetWithRange:function(o,t,r){return jt(o,t,r)},ellipse:function(o,t,r,s,e){let n=_e(r,s,e);return he(o,t,e,n).opset},doubleLineOps:function(o,t,r,s,e){return ut(o,t,r,s,e,!0)}};function Oe(o,t,r,s,e){return{type:"path",ops:ut(o,t,r,s,e)}}function _t(o,t,r){let s=(o||[]).length;if(s>2){let e=[];for(let n=0;n<s-1;n++)e.push(...ut(o[n][0],o[n][1],o[n+1][0],o[n+1][1],r));return t&&e.push(...ut(o[s-1][0],o[s-1][1],o[0][0],o[0][1],r)),{type:"path",ops:e}}return s===2?Oe(o[0][0],o[0][1],o[1][0],o[1][1],r):{type:"path",ops:[]}}function fa(o,t,r,s,e){return(function(n,h){return _t(n,!0,h)})([[o,t],[o+r,t],[o+r,t+s],[o,t+s]],e)}function Ce(o,t){if(o.length){let r=typeof o[0][0]=="number"?[o]:o,s=Et(r[0],1*(1+.2*t.roughness),t),e=t.disableMultiStroke?[]:Et(r[0],1.5*(1+.22*t.roughness),Ae(t));for(let n=1;n<r.length;n++){let h=r[n];if(h.length){let a=Et(h,1*(1+.2*t.roughness),t),c=t.disableMultiStroke?[]:Et(h,1.5*(1+.22*t.roughness),Ae(t));for(let i of a)i.op!=="move"&&s.push(i);for(let i of c)i.op!=="move"&&e.push(i)}}return{type:"path",ops:s.concat(e)}}return{type:"path",ops:[]}}function _e(o,t,r){let s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(o/2,2)+Math.pow(t/2,2))/2)),e=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*s)),n=2*Math.PI/e,h=Math.abs(o/2),a=Math.abs(t/2),c=1-r.curveFitting;return h+=G(h*c,r),a+=G(a*c,r),{increment:n,rx:h,ry:a}}function he(o,t,r,s){let[e,n]=Le(s.increment,o,t,s.rx,s.ry,1,s.increment*jt(.1,jt(.4,1,r),r),r),h=Gt(e,null,r);if(!r.disableMultiStroke&&r.roughness!==0){let[a]=Le(s.increment,o,t,s.rx,s.ry,1.5,0,r),c=Gt(a,null,r);h=h.concat(c)}return{estimatedPoints:n,opset:{type:"path",ops:h}}}function Ne(o,t,r,s,e,n,h,a,c){let i=o,l=t,g=Math.abs(r/2),f=Math.abs(s/2);g+=G(.01*g,c),f+=G(.01*f,c);let p=e,u=n;for(;p<0;)p+=2*Math.PI,u+=2*Math.PI;u-p>2*Math.PI&&(p=0,u=2*Math.PI);let y=2*Math.PI/c.curveStepCount,m=Math.min(y/2,(u-p)/2),d=We(m,i,l,g,f,p,u,1,c);if(!c.disableMultiStroke){let x=We(m,i,l,g,f,p,u,1.5,c);d.push(...x)}return h&&(a?d.push(...ut(i,l,i+g*Math.cos(p),l+f*Math.sin(p),c),...ut(i,l,i+g*Math.cos(u),l+f*Math.sin(u),c)):d.push({op:"lineTo",data:[i,l]},{op:"lineTo",data:[i+g*Math.cos(p),l+f*Math.sin(p)]})),{type:"path",ops:d}}function Re(o,t){let r=Ie(He(ye(o))),s=[],e=[0,0],n=[0,0];for(let{key:h,data:a}of r)switch(h){case"M":n=[a[0],a[1]],e=[a[0],a[1]];break;case"L":s.push(...ut(n[0],n[1],a[0],a[1],t)),n=[a[0],a[1]];break;case"C":{let[c,i,l,g,f,p]=a;s.push(...ua(c,i,l,g,f,p,n,t)),n=[f,p];break}case"Z":s.push(...ut(n[0],n[1],e[0],e[1],t)),n=[e[0],e[1]]}return{type:"path",ops:s}}function se(o,t){let r=[];for(let s of o)if(s.length){let e=t.maxRandomnessOffset||0,n=s.length;if(n>2){r.push({op:"move",data:[s[0][0]+G(e,t),s[0][1]+G(e,t)]});for(let h=1;h<n;h++)r.push({op:"lineTo",data:[s[h][0]+G(e,t),s[h][1]+G(e,t)]})}}return{type:"fillPath",ops:r}}function $t(o,t){return(function(r,s){let e=r.fillStyle||"hachure";if(!nt[e])switch(e){case"zigzag":nt[e]||(nt[e]=new re(s));break;case"cross-hatch":nt[e]||(nt[e]=new ne(s));break;case"dots":nt[e]||(nt[e]=new ie(s));break;case"dashed":nt[e]||(nt[e]=new le(s));break;case"zigzag-line":nt[e]||(nt[e]=new ce(s));break;default:e="hachure",nt[e]||(nt[e]=new Rt(s))}return nt[e]})(t,pa).fillPolygons(o,t)}function Ae(o){let t=Object.assign({},o);return t.randomizer=void 0,o.seed&&(t.seed=o.seed+1),t}function ze(o){return o.randomizer||(o.randomizer=new oe(o.seed||0)),o.randomizer.next()}function jt(o,t,r,s=1){return r.roughness*s*(ze(r)*(t-o)+o)}function G(o,t,r=1){return jt(-o,o,t,r)}function ut(o,t,r,s,e,n=!1){let h=n?e.disableMultiStrokeFill:e.disableMultiStroke,a=ge(o,t,r,s,e,!0,!1);if(h)return a;let c=ge(o,t,r,s,e,!0,!0);return a.concat(c)}function ge(o,t,r,s,e,n,h){let a=Math.pow(o-r,2)+Math.pow(t-s,2),c=Math.sqrt(a),i=1;i=c<200?1:c>500?.4:-.0016668*c+1.233334;let l=e.maxRandomnessOffset||0;l*l*100>a&&(l=c/10);let g=l/2,f=.2+.2*ze(e),p=e.bowing*e.maxRandomnessOffset*(s-t)/200,u=e.bowing*e.maxRandomnessOffset*(o-r)/200;p=G(p,e,i),u=G(u,e,i);let y=[],m=()=>G(g,e,i),d=()=>G(l,e,i),x=e.preserveVertices;return n&&(h?y.push({op:"move",data:[o+(x?0:m()),t+(x?0:m())]}):y.push({op:"move",data:[o+(x?0:G(l,e,i)),t+(x?0:G(l,e,i))]})),h?y.push({op:"bcurveTo",data:[p+o+(r-o)*f+m(),u+t+(s-t)*f+m(),p+o+2*(r-o)*f+m(),u+t+2*(s-t)*f+m(),r+(x?0:m()),s+(x?0:m())]}):y.push({op:"bcurveTo",data:[p+o+(r-o)*f+d(),u+t+(s-t)*f+d(),p+o+2*(r-o)*f+d(),u+t+2*(s-t)*f+d(),r+(x?0:d()),s+(x?0:d())]}),y}function Et(o,t,r){if(!o.length)return[];let s=[];s.push([o[0][0]+G(t,r),o[0][1]+G(t,r)]),s.push([o[0][0]+G(t,r),o[0][1]+G(t,r)]);for(let e=1;e<o.length;e++)s.push([o[e][0]+G(t,r),o[e][1]+G(t,r)]),e===o.length-1&&s.push([o[e][0]+G(t,r),o[e][1]+G(t,r)]);return Gt(s,null,r)}function Gt(o,t,r){let s=o.length,e=[];if(s>3){let n=[],h=1-r.curveTightness;e.push({op:"move",data:[o[1][0],o[1][1]]});for(let a=1;a+2<s;a++){let c=o[a];n[0]=[c[0],c[1]],n[1]=[c[0]+(h*o[a+1][0]-h*o[a-1][0])/6,c[1]+(h*o[a+1][1]-h*o[a-1][1])/6],n[2]=[o[a+1][0]+(h*o[a][0]-h*o[a+2][0])/6,o[a+1][1]+(h*o[a][1]-h*o[a+2][1])/6],n[3]=[o[a+1][0],o[a+1][1]],e.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]]})}if(t&&t.length===2){let a=r.maxRandomnessOffset;e.push({op:"lineTo",data:[t[0]+G(a,r),t[1]+G(a,r)]})}}else s===3?(e.push({op:"move",data:[o[1][0],o[1][1]]}),e.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[2][0],o[2][1]]})):s===2&&e.push(...ge(o[0][0],o[0][1],o[1][0],o[1][1],r,!0,!0));return e}function Le(o,t,r,s,e,n,h,a){let c=[],i=[];if(a.roughness===0){o/=4,i.push([t+s*Math.cos(-o),r+e*Math.sin(-o)]);for(let l=0;l<=2*Math.PI;l+=o){let g=[t+s*Math.cos(l),r+e*Math.sin(l)];c.push(g),i.push(g)}i.push([t+s*Math.cos(0),r+e*Math.sin(0)]),i.push([t+s*Math.cos(o),r+e*Math.sin(o)])}else{let l=G(.5,a)-Math.PI/2;i.push([G(n,a)+t+.9*s*Math.cos(l-o),G(n,a)+r+.9*e*Math.sin(l-o)]);let g=2*Math.PI+l-.01;for(let f=l;f<g;f+=o){let p=[G(n,a)+t+s*Math.cos(f),G(n,a)+r+e*Math.sin(f)];c.push(p),i.push(p)}i.push([G(n,a)+t+s*Math.cos(l+2*Math.PI+.5*h),G(n,a)+r+e*Math.sin(l+2*Math.PI+.5*h)]),i.push([G(n,a)+t+.98*s*Math.cos(l+h),G(n,a)+r+.98*e*Math.sin(l+h)]),i.push([G(n,a)+t+.9*s*Math.cos(l+.5*h),G(n,a)+r+.9*e*Math.sin(l+.5*h)])}return[i,c]}function We(o,t,r,s,e,n,h,a,c){let i=n+G(.1,c),l=[];l.push([G(a,c)+t+.9*s*Math.cos(i-o),G(a,c)+r+.9*e*Math.sin(i-o)]);for(let g=i;g<=h;g+=o)l.push([G(a,c)+t+s*Math.cos(g),G(a,c)+r+e*Math.sin(g)]);return l.push([t+s*Math.cos(h),r+e*Math.sin(h)]),l.push([t+s*Math.cos(h),r+e*Math.sin(h)]),Gt(l,null,c)}function ua(o,t,r,s,e,n,h,a){let c=[],i=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],l=[0,0],g=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let p=0;p<g;p++)p===0?c.push({op:"move",data:[h[0],h[1]]}):c.push({op:"move",data:[h[0]+(f?0:G(i[0],a)),h[1]+(f?0:G(i[0],a))]}),l=f?[e,n]:[e+G(i[p],a),n+G(i[p],a)],c.push({op:"bcurveTo",data:[o+G(i[p],a),t+G(i[p],a),r+G(i[p],a),s+G(i[p],a),l[0],l[1]]});return c}function Nt(o){return[...o]}function Te(o,t=0){let r=o.length;if(r<3)throw new Error("A curve must have at least three points.");let s=[];if(r===3)s.push(Nt(o[0]),Nt(o[1]),Nt(o[2]),Nt(o[2]));else{let e=[];e.push(o[0],o[0]);for(let a=1;a<o.length;a++)e.push(o[a]),a===o.length-1&&e.push(o[a]);let n=[],h=1-t;s.push(Nt(e[0]));for(let a=1;a+2<e.length;a++){let c=e[a];n[0]=[c[0],c[1]],n[1]=[c[0]+(h*e[a+1][0]-h*e[a-1][0])/6,c[1]+(h*e[a+1][1]-h*e[a-1][1])/6],n[2]=[e[a+1][0]+(h*e[a][0]-h*e[a+2][0])/6,e[a+1][1]+(h*e[a][1]-h*e[a+2][1])/6],n[3]=[e[a+1][0],e[a+1][1]],s.push(n[1],n[2],n[3])}}return s}function zt(o,t){return Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)}function ya(o,t,r){let s=zt(t,r);if(s===0)return zt(o,t);let e=((o[0]-t[0])*(r[0]-t[0])+(o[1]-t[1])*(r[1]-t[1]))/s;return e=Math.max(0,Math.min(1,e)),zt(o,bt(t,r,e))}function bt(o,t,r){return[o[0]+(t[0]-o[0])*r,o[1]+(t[1]-o[1])*r]}function pe(o,t,r,s){let e=s||[];if((function(a,c){let i=a[c+0],l=a[c+1],g=a[c+2],f=a[c+3],p=3*l[0]-2*i[0]-f[0];p*=p;let u=3*l[1]-2*i[1]-f[1];u*=u;let y=3*g[0]-2*f[0]-i[0];y*=y;let m=3*g[1]-2*f[1]-i[1];return m*=m,p<y&&(p=y),u<m&&(u=m),p+u})(o,t)<r){let a=o[t+0];e.length?(n=e[e.length-1],h=a,Math.sqrt(zt(n,h))>1&&e.push(a)):e.push(a),e.push(o[t+3])}else{let c=o[t+0],i=o[t+1],l=o[t+2],g=o[t+3],f=bt(c,i,.5),p=bt(i,l,.5),u=bt(l,g,.5),y=bt(f,p,.5),m=bt(p,u,.5),d=bt(y,m,.5);pe([c,f,y,d],0,r,e),pe([d,m,u,g],0,r,e)}var n,h;return e}function da(o,t){return qt(o,0,o.length,t)}function qt(o,t,r,s,e){let n=e||[],h=o[t],a=o[r-1],c=0,i=1;for(let l=t+1;l<r-1;++l){let g=ya(o[l],h,a);g>c&&(c=g,i=l)}return Math.sqrt(c)>s?(qt(o,t,i+1,s,n),qt(o,i,r,s,n)):(n.length||n.push(h),n.push(a)),n}function ae(o,t=.15,r){let s=[],e=(o.length-1)/3;for(let n=0;n<e;n++)pe(o,3*n,t,s);return r&&r>0?qt(s,0,s.length,r):s}var ct="none",Mt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,r,s){return{shape:t,sets:r||[],options:s||this.defaultOptions}}line(t,r,s,e,n){let h=this._o(n);return this._d("line",[Oe(t,r,s,e,h)],h)}rectangle(t,r,s,e,n){let h=this._o(n),a=[],c=fa(t,r,s,e,h);if(h.fill){let i=[[t,r],[t+s,r],[t+s,r+e],[t,r+e]];h.fillStyle==="solid"?a.push(se([i],h)):a.push($t([i],h))}return h.stroke!==ct&&a.push(c),this._d("rectangle",a,h)}ellipse(t,r,s,e,n){let h=this._o(n),a=[],c=_e(s,e,h),i=he(t,r,h,c);if(h.fill)if(h.fillStyle==="solid"){let l=he(t,r,h,c).opset;l.type="fillPath",a.push(l)}else a.push($t([i.estimatedPoints],h));return h.stroke!==ct&&a.push(i.opset),this._d("ellipse",a,h)}circle(t,r,s,e){let n=this.ellipse(t,r,s,s,e);return n.shape="circle",n}linearPath(t,r){let s=this._o(r);return this._d("linearPath",[_t(t,!1,s)],s)}arc(t,r,s,e,n,h,a=!1,c){let i=this._o(c),l=[],g=Ne(t,r,s,e,n,h,a,!0,i);if(a&&i.fill)if(i.fillStyle==="solid"){let f=Object.assign({},i);f.disableMultiStroke=!0;let p=Ne(t,r,s,e,n,h,!0,!1,f);p.type="fillPath",l.push(p)}else l.push((function(f,p,u,y,m,d,x){let b=f,w=p,$=Math.abs(u/2),M=Math.abs(y/2);$+=G(.01*$,x),M+=G(.01*M,x);let D=m,v=d;for(;D<0;)D+=2*Math.PI,v+=2*Math.PI;v-D>2*Math.PI&&(D=0,v=2*Math.PI);let P=(v-D)/x.curveStepCount,R=[];for(let O=D;O<=v;O+=P)R.push([b+$*Math.cos(O),w+M*Math.sin(O)]);return R.push([b+$*Math.cos(v),w+M*Math.sin(v)]),R.push([b,w]),$t([R],x)})(t,r,s,e,n,h,i));return i.stroke!==ct&&l.push(g),this._d("arc",l,i)}curve(t,r){let s=this._o(r),e=[],n=Ce(t,s);if(s.fill&&s.fill!==ct)if(s.fillStyle==="solid"){let h=Ce(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],a=t;if(a.length){let c=typeof a[0][0]=="number"?[a]:a;for(let i of c)i.length<3?h.push(...i):i.length===3?h.push(...ae(Te([i[0],i[0],i[1],i[2]]),10,(1+s.roughness)/2)):h.push(...ae(Te(i),10,(1+s.roughness)/2))}h.length&&e.push($t([h],s))}return s.stroke!==ct&&e.push(n),this._d("curve",e,s)}polygon(t,r){let s=this._o(r),e=[],n=_t(t,!0,s);return s.fill&&(s.fillStyle==="solid"?e.push(se([t],s)):e.push($t([t],s))),s.stroke!==ct&&e.push(n),this._d("polygon",e,s)}path(t,r){let s=this._o(r),e=[];if(!t)return this._d("path",e,s);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let n=s.fill&&s.fill!=="transparent"&&s.fill!==ct,h=s.stroke!==ct,a=!!(s.simplification&&s.simplification<1),c=(function(l,g,f){let p=Ie(He(ye(l))),u=[],y=[],m=[0,0],d=[],x=()=>{d.length>=4&&y.push(...ae(d,g)),d=[]},b=()=>{x(),y.length&&(u.push(y),y=[])};for(let{key:$,data:M}of p)switch($){case"M":b(),m=[M[0],M[1]],y.push(m);break;case"L":x(),y.push([M[0],M[1]]);break;case"C":if(!d.length){let D=y.length?y[y.length-1]:m;d.push([D[0],D[1]])}d.push([M[0],M[1]]),d.push([M[2],M[3]]),d.push([M[4],M[5]]);break;case"Z":x(),y.push([m[0],m[1]])}if(b(),!f)return u;let w=[];for(let $ of u){let M=da($,f);M.length&&w.push(M)}return w})(t,1,a?4-4*(s.simplification||1):(1+s.roughness)/2),i=Re(t,s);if(n)if(s.fillStyle==="solid")if(c.length===1){let l=Re(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(l.ops)})}else e.push(se(c,s));else e.push($t(c,s));return h&&(a?c.forEach(l=>{e.push(_t(l,!1,s))}):e.push(i)),this._d("path",e,s)}opsToPath(t,r){let s="";for(let e of t.ops){let n=typeof r=="number"&&r>=0?e.data.map(h=>+h.toFixed(r)):e.data;switch(e.op){case"move":s+=`M${n[0]} ${n[1]} `;break;case"bcurveTo":s+=`C${n[0]} ${n[1]}, ${n[2]} ${n[3]}, ${n[4]} ${n[5]} `;break;case"lineTo":s+=`L${n[0]} ${n[1]} `}}return s.trim()}toPaths(t){let r=t.sets||[],s=t.options||this.defaultOptions,e=[];for(let n of r){let h=null;switch(n.type){case"path":h={d:this.opsToPath(n),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:ct};break;case"fillPath":h={d:this.opsToPath(n),stroke:ct,strokeWidth:0,fill:s.fill||ct};break;case"fillSketch":h=this.fillSketch(n,s)}h&&e.push(h)}return e}fillSketch(t,r){let s=r.fillWeight;return s<0&&(s=r.strokeWidth/2),{d:this.opsToPath(t),stroke:r.fill||ct,strokeWidth:s,fill:ct}}_mergedShape(t){return t.filter((r,s)=>s===0||r.op!=="move")}},fe=class{constructor(t,r){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Mt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.ctx,n=t.options.fixedDecimalPlaceDigits;for(let h of r)switch(h.type){case"path":e.save(),e.strokeStyle=s.stroke==="none"?"transparent":s.stroke,e.lineWidth=s.strokeWidth,s.strokeLineDash&&e.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(e.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(e,h,n),e.restore();break;case"fillPath":{e.save(),e.fillStyle=s.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(e,h,n,a),e.restore();break}case"fillSketch":this.fillSketch(e,h,s)}}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2),t.save(),s.fillLineDash&&t.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(t.lineDashOffset=s.fillLineDashOffset),t.strokeStyle=s.fill||"",t.lineWidth=e,this._drawToContext(t,r,s.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,r,s,e="nonzero"){t.beginPath();for(let n of r.ops){let h=typeof s=="number"&&s>=0?n.data.map(a=>+a.toFixed(s)):n.data;switch(n.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}r.type==="fillPath"?t.fill(e):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,r,s,e,n){let h=this.gen.line(t,r,s,e,n);return this.draw(h),h}rectangle(t,r,s,e,n){let h=this.gen.rectangle(t,r,s,e,n);return this.draw(h),h}ellipse(t,r,s,e,n){let h=this.gen.ellipse(t,r,s,e,n);return this.draw(h),h}circle(t,r,s,e){let n=this.gen.circle(t,r,s,e);return this.draw(n),n}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s),s}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s),s}arc(t,r,s,e,n,h,a=!1,c){let i=this.gen.arc(t,r,s,e,n,h,a,c);return this.draw(i),i}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s),s}path(t,r){let s=this.gen.path(t,r);return this.draw(s),s}},Ot="http://www.w3.org/2000/svg",ue=class{constructor(t,r){this.svg=t,this.gen=new Mt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.svg.ownerDocument||window.document,n=e.createElementNS(Ot,"g"),h=t.options.fixedDecimalPlaceDigits;for(let a of r){let c=null;switch(a.type){case"path":c=e.createElementNS(Ot,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke",s.stroke),c.setAttribute("stroke-width",s.strokeWidth+""),c.setAttribute("fill","none"),s.strokeLineDash&&c.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break;case"fillPath":c=e.createElementNS(Ot,"path"),c.setAttribute("d",this.opsToPath(a,h)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",s.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(e,a,s)}c&&n.appendChild(c)}return n}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2);let n=t.createElementNS(Ot,"path");return n.setAttribute("d",this.opsToPath(r,s.fixedDecimalPlaceDigits)),n.setAttribute("stroke",s.fill||""),n.setAttribute("stroke-width",e+""),n.setAttribute("fill","none"),s.fillLineDash&&n.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&n.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),n}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,r){return this.gen.opsToPath(t,r)}line(t,r,s,e,n){let h=this.gen.line(t,r,s,e,n);return this.draw(h)}rectangle(t,r,s,e,n){let h=this.gen.rectangle(t,r,s,e,n);return this.draw(h)}ellipse(t,r,s,e,n){let h=this.gen.ellipse(t,r,s,e,n);return this.draw(h)}circle(t,r,s,e){let n=this.gen.circle(t,r,s,e);return this.draw(n)}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s)}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s)}arc(t,r,s,e,n,h,a=!1,c){let i=this.gen.arc(t,r,s,e,n,h,a,c);return this.draw(i)}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s)}path(t,r){let s=this.gen.path(t,r);return this.draw(s)}},S={canvas:(o,t)=>new fe(o,t),svg:(o,t)=>new ue(o,t),generator:o=>new Mt(o),newSeed:()=>Mt.newSeed()};var q=k((o,t,r)=>C(null,null,function*(){let s,e=t.useHtmlLabels||tt(U()?.htmlLabels);r?s=r:s="node default";let n=o.insert("g").attr("class",s).attr("id",t.domId||t.id),h=n.insert("g").attr("class","label").attr("style",at(t.labelStyle)),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let c=yield ft(h,Ht(St(a),U()),{useHtmlLabels:e,width:t.width||U().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),i=c.getBBox(),l=(t?.padding??0)/2;if(e){let g=c.children[0],f=K(c),p=g.getElementsByTagName("img");if(p){let u=a.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...p].map(y=>new Promise(m=>{function d(){if(y.style.display="flex",y.style.flexDirection="column",u){let x=U().fontSize?U().fontSize:window.getComputedStyle(document.body).fontSize,b=5,[w=Me.fontSize]=Pe(x),$=w*b+"px";y.style.minWidth=$,y.style.maxWidth=$}else y.style.width="100%";m(y)}k(d,"setupImage"),setTimeout(()=>{y.complete&&d()}),y.addEventListener("error",d),y.addEventListener("load",d)})))}i=g.getBoundingClientRect(),f.attr("width",i.width),f.attr("height",i.height)}return e?h.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"):h.attr("transform","translate(0, "+-i.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:n,bbox:i,halfPadding:l,label:h}}),"labelHelper"),de=k((o,t,r)=>C(null,null,function*(){let s=r.useHtmlLabels||tt(U()?.flowchart?.htmlLabels),e=o.insert("g").attr("class","label").attr("style",r.labelStyle||""),n=yield ft(e,Ht(St(t),U()),{useHtmlLabels:s,width:r.width||U()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),h=n.getBBox(),a=r.padding/2;if(tt(U()?.flowchart?.htmlLabels)){let c=n.children[0],i=K(n);h=c.getBoundingClientRect(),i.attr("width",h.width),i.attr("height",h.height)}return s?e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):e.attr("transform","translate(0, "+-h.height/2+")"),r.centerLabel&&e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),e.insert("rect",":first-child"),{shapeSvg:o,bbox:h,halfPadding:a,label:e}}),"insertLabel"),T=k((o,t)=>{let r=t.node().getBBox();o.width=r.width,o.height=r.height},"updateNodeBounds"),_=k((o,t)=>(o.look==="handDrawn"?"rough-node":"node")+" "+o.cssClasses+" "+(t||""),"getNodeClasses");function Z(o){let t=o.map((r,s)=>`${s===0?"M":"L"}${r.x},${r.y}`);return t.push("Z"),t.join(" ")}k(Z,"createPathFromPoints");function yt(o,t,r,s,e,n){let h=[],c=r-o,i=s-t,l=c/n,g=2*Math.PI/l,f=t+i/2;for(let p=0;p<=50;p++){let u=p/50,y=o+u*c,m=f+e*Math.sin(g*(y-o));h.push({x:y,y:m})}return h}k(yt,"generateFullSineWavePoints");function Tt(o,t,r,s,e,n){let h=[],a=e*Math.PI/180,l=(n*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}k(Tt,"generateCirclePoints");var ma=k((o,t)=>{var r=o.x,s=o.y,e=t.x-r,n=t.y-s,h=o.width/2,a=o.height/2,c,i;return Math.abs(n)*h>Math.abs(e)*a?(n<0&&(a=-a),c=n===0?0:a*e/n,i=a):(e<0&&(h=-h),c=h,i=e===0?0:h*n/e),{x:r+c,y:s+i}},"intersectRect"),vt=ma;function je(o,t){t&&o.attr("style",t)}k(je,"applyStyle");function Ge(o){return C(this,null,function*(){let t=K(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=t.append("xhtml:div"),s=U(),e=o.label;o.label&&Qt(o.label)&&(e=yield ke(o.label.replace(ve.lineBreakRegex,`
`),s));let h='<span class="'+(o.isNode?"nodeLabel":"edgeLabel")+'" '+(o.labelStyle?'style="'+o.labelStyle+'"':"")+">"+e+"</span>";return r.html(Ht(h,s)),je(r,o.labelStyle),r.style("display","inline-block"),r.style("padding-right","1px"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}k(Ge,"addHtmlLabel");var xa=k((o,t,r,s)=>C(null,null,function*(){let e=o||"";if(typeof e=="object"&&(e=e[0]),tt(U().flowchart.htmlLabels)){e=e.replace(/\\n|\n/g,"<br />"),Q.info("vertexText"+e);let n={isNode:s,label:St(e).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield Ge(n)}else{let n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof e=="string"?h=e.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(e)?h=e:h=[];for(let a of h){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),r?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=a.trim(),n.appendChild(c)}return n}}),"createLabel"),me=xa,dt=k((o,t,r,s,e)=>["M",o+e,t,"H",o+r-e,"A",e,e,0,0,1,o+r,t+e,"V",t+s-e,"A",e,e,0,0,1,o+r-e,t+s,"H",o+e,"A",e,e,0,0,1,o,t+s-e,"V",t+e,"A",e,e,0,0,1,o+e,t,"Z"].join(" "),"createRoundedRectPathD"),qe=k((o,t)=>C(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:n,clusterBorder:h}=s,{labelStyles:a,nodeStyles:c,borderStyles:i,backgroundStyles:l}=W(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=yield ft(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],v=K(u);y=D.getBoundingClientRect(),v.attr("width",y.width),v.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,b=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let w;if(t.look==="handDrawn"){let D=S.svg(g),v=L(t,{roughness:.7,fill:n,stroke:h,fillWeight:3,seed:e}),P=D.path(dt(x,b,m,d,0),v);w=g.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),w.select("path:nth-child(2)").attr("style",i.join(";")),w.select("path").attr("style",l.join(";").replace("fill","stroke"))}else w=g.insert("rect",":first-child"),w.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:$}=Kt(r);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+$})`),a){let D=p.select("span");D&&D.attr("style",a)}let M=w.node().getBBox();return t.offsetX=0,t.width=M.width,t.height=M.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return vt(t,D)},{cluster:g,labelBBox:y}}),"rect"),ba=k((o,t)=>{let r=o.insert("g").attr("class","note-cluster").attr("id",t.id),s=r.insert("rect",":first-child"),e=0*t.padding,n=e/2;s.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-n).attr("y",t.y-t.height/2-n).attr("width",t.width+e).attr("height",t.height+e).attr("fill","none");let h=s.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(a){return vt(t,a)},{cluster:r,labelBBox:{width:0,height:0}}},"noteGroup"),wa=k((o,t)=>C(null,null,function*(){let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{altBackground:n,compositeBackground:h,compositeTitleBackground:a,nodeBorder:c}=s,i=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),l=i.insert("g",":first-child"),g=i.insert("g").attr("class","cluster-label"),f=i.append("rect"),p=g.node().appendChild(yield me(t.label,t.labelStyle,void 0,!0)),u=p.getBBox();if(tt(r.flowchart.htmlLabels)){let P=p.children[0],R=K(p);u=P.getBoundingClientRect(),R.attr("width",u.width),R.attr("height",u.height)}let y=0*t.padding,m=y/2,d=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+y,b=t.height+y-u.height-6,w=t.x-d/2,$=t.y-x/2;t.width=d;let M=t.y-t.height/2-m+u.height+2,D;if(t.look==="handDrawn"){let P=t.cssClasses.includes("statediagram-cluster-alt"),R=S.svg(i),O=t.rx||t.ry?R.path(dt(w,$,d,x,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:c,seed:e}):R.rectangle(w,$,d,x,{seed:e});D=i.insert(()=>O,":first-child");let V=R.rectangle(w,M,d,b,{fill:P?n:h,fillStyle:P?"hachure":"solid",stroke:c,seed:e});D=i.insert(()=>O,":first-child"),f=i.insert(()=>V)}else D=l.insert("rect",":first-child"),D.attr("class","outer").attr("x",w).attr("y",$).attr("width",d).attr("height",x).attr("data-look",t.look),f.attr("class","inner").attr("x",w).attr("y",M).attr("width",d).attr("height",b);g.attr("transform",`translate(${t.x-u.width/2}, ${$+1-(tt(r.flowchart.htmlLabels)?0:3)})`);let v=D.node().getBBox();return t.height=v.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(P){return vt(t,P)},{cluster:i,labelBBox:u}}),"roundedWithTitle"),Sa=k((o,t)=>C(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:n,clusterBorder:h}=s,{labelStyles:a,nodeStyles:c,borderStyles:i,backgroundStyles:l}=W(t),g=o.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=yield ft(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0,width:t.width}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],v=K(u);y=D.getBoundingClientRect(),v.attr("width",y.width),v.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,b=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let w;if(t.look==="handDrawn"){let D=S.svg(g),v=L(t,{roughness:.7,fill:n,stroke:h,fillWeight:4,seed:e}),P=D.path(dt(x,b,m,d,t.rx),v);w=g.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),w.select("path:nth-child(2)").attr("style",i.join(";")),w.select("path").attr("style",l.join(";").replace("fill","stroke"))}else w=g.insert("rect",":first-child"),w.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",b).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:$}=Kt(r);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+$})`),a){let D=p.select("span");D&&D.attr("style",a)}let M=w.node().getBBox();return t.offsetX=0,t.width=M.width,t.height=M.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return vt(t,D)},{cluster:g,labelBBox:y}}),"kanbanSection"),$a=k((o,t)=>{let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{nodeBorder:n}=s,h=o.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=h.insert("g",":first-child"),c=0*t.padding,i=t.width+c;t.diff=-t.padding;let l=t.height+c,g=t.x-i/2,f=t.y-l/2;t.width=i;let p;if(t.look==="handDrawn"){let m=S.svg(h).rectangle(g,f,i,l,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:n,seed:e});p=h.insert(()=>m,":first-child")}else p=a.insert("rect",":first-child"),p.attr("class","divider").attr("x",g).attr("y",f).attr("width",i).attr("height",l).attr("data-look",t.look);let u=p.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return vt(t,y)},{cluster:h,labelBBox:{}}},"divider"),Ma=qe,ka={rect:qe,squareRect:Ma,roundedWithTitle:wa,noteGroup:ba,divider:$a,kanbanSection:Sa},Fe=new Map,sr=k((o,t)=>C(null,null,function*(){let r=t.shape||"rect",s=yield ka[r](o,t);return Fe.set(t.id,s),s}),"insertCluster"),ar=k(()=>{Fe=new Map},"clear");function Xe(o,t){return o.intersect(t)}k(Xe,"intersectNode");var va=Xe;function Ye(o,t,r,s){var e=o.x,n=o.y,h=e-s.x,a=n-s.y,c=Math.sqrt(t*t*a*a+r*r*h*h),i=Math.abs(t*r*h/c);s.x<e&&(i=-i);var l=Math.abs(t*r*a/c);return s.y<n&&(l=-l),{x:e+i,y:n+l}}k(Ye,"intersectEllipse");var Ve=Ye;function Ze(o,t,r){return Ve(o,t,t,r)}k(Ze,"intersectCircle");var Da=Ze;function Qe(o,t,r,s){{let e=t.y-o.y,n=o.x-t.x,h=t.x*o.y-o.x*t.y,a=e*r.x+n*r.y+h,c=e*s.x+n*s.y+h,i=1e-6;if(a!==0&&c!==0&&xe(a,c))return;let l=s.y-r.y,g=r.x-s.x,f=s.x*r.y-r.x*s.y,p=l*o.x+g*o.y+f,u=l*t.x+g*t.y+f;if(Math.abs(p)<i&&Math.abs(u)<i&&xe(p,u))return;let y=e*g-l*n;if(y===0)return;let m=Math.abs(y/2),d=n*f-g*h,x=d<0?(d-m)/y:(d+m)/y;d=l*h-e*f;let b=d<0?(d-m)/y:(d+m)/y;return{x,y:b}}}k(Qe,"intersectLine");function xe(o,t){return o*t>0}k(xe,"sameSign");var Pa=Qe;function Je(o,t,r){let s=o.x,e=o.y,n=[],h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(l){h=Math.min(h,l.x),a=Math.min(a,l.y)}):(h=Math.min(h,t.x),a=Math.min(a,t.y));let c=s-o.width/2-h,i=e-o.height/2-a;for(let l=0;l<t.length;l++){let g=t[l],f=t[l<t.length-1?l+1:0],p=Pa(o,r,{x:c+g.x,y:i+g.y},{x:c+f.x,y:i+f.y});p&&n.push(p)}return n.length?(n.length>1&&n.sort(function(l,g){let f=l.x-r.x,p=l.y-r.y,u=Math.sqrt(f*f+p*p),y=g.x-r.x,m=g.y-r.y,d=Math.sqrt(y*y+m*m);return u<d?-1:u===d?0:1}),n[0]):o}k(Je,"intersectPolygon");var Ba=Je,N={node:va,circle:Da,ellipse:Ve,polygon:Ba,rect:vt};function Ke(o,t){let{labelStyles:r}=W(t);t.labelStyle=r;let s=_(t),e=s;s||(e="anchor");let n=o.insert("g").attr("class",e).attr("id",t.domId||t.id),h=1,{cssStyles:a}=t,c=S.svg(n),i=L(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(i.roughness=0);let l=c.circle(0,0,h*2,i),g=n.insert(()=>l,":first-child");return g.attr("class","anchor").attr("style",at(a)),T(t,g),t.intersect=function(f){return Q.info("Circle intersect",t,h,f),N.circle(t,h,f)},n}k(Ke,"anchor");function be(o,t,r,s,e,n,h){let c=(o+r)/2,i=(t+s)/2,l=Math.atan2(s-t,r-o),g=(r-o)/2,f=(s-t)/2,p=g/e,u=f/n,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=c+m*n*Math.sin(l)*(h?-1:1),x=i-m*e*Math.cos(l)*(h?-1:1),b=Math.atan2((t-x)/n,(o-d)/e),$=Math.atan2((s-x)/n,(r-d)/e)-b;h&&$<0&&($+=2*Math.PI),!h&&$>0&&($-=2*Math.PI);let M=[];for(let D=0;D<20;D++){let v=D/19,P=b+v*$,R=d+e*Math.cos(P),O=x+n*Math.sin(P);M.push({x:R,y:O})}return M}k(be,"generateArcPoints");function Ue(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.width+t.padding+20,a=n.height+t.padding,c=a/2,i=c/(2.5+a/50),{cssStyles:l}=t,g=[{x:h/2,y:-a/2},{x:-h/2,y:-a/2},...be(-h/2,-a/2,-h/2,a/2,i,c,!1),{x:h/2,y:a/2},...be(h/2,a/2,h/2,-a/2,i,c,!0)],f=S.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=Z(g),y=f.path(u,p),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(${i/2}, 0)`),T(t,m),t.intersect=function(d){return N.polygon(t,g,d)},e})}k(Ue,"bowTieRect");function mt(o,t,r,s){return o.insert("polygon",":first-child").attr("points",s.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+r/2+")")}k(mt,"insertPolygonShape");function ts(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.height+t.padding,a=12,c=n.width+t.padding+a,i=0,l=c,g=-h,f=0,p=[{x:i+a,y:g},{x:l,y:g},{x:l,y:f},{x:i,y:f},{x:i,y:g+a},{x:i+a,y:g}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let m=S.svg(e),d=L(t,{}),x=Z(p),b=m.path(x,d);u=e.insert(()=>b,":first-child").attr("transform",`translate(${-c/2}, ${h/2})`),y&&u.attr("style",y)}else u=mt(e,c,h,p);return s&&u.attr("style",s),T(t,u),t.intersect=function(m){return N.polygon(t,p,m)},e})}k(ts,"card");function es(o,t){let{nodeStyles:r}=W(t);t.label="";let s=o.insert("g").attr("class",_(t)).attr("id",t.domId??t.id),{cssStyles:e}=t,n=Math.max(28,t.width??0),h=[{x:0,y:n/2},{x:n/2,y:0},{x:0,y:-n/2},{x:-n/2,y:0}],a=S.svg(s),c=L(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let i=Z(h),l=a.path(i,c),g=s.insert(()=>l,":first-child");return e&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",e),r&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",r),t.width=28,t.height=28,t.intersect=function(f){return N.polygon(t,h,f)},s}k(es,"choice");function we(o,t,r){return C(this,null,function*(){let{labelStyles:s,nodeStyles:e}=W(t);t.labelStyle=s;let{shapeSvg:n,bbox:h,halfPadding:a}=yield q(o,t,_(t)),c=r?.padding??a,i=h.width/2+c,l,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=S.svg(n),p=L(t,{}),u=f.circle(0,0,i*2,p);l=n.insert(()=>u,":first-child"),l.attr("class","basic label-container").attr("style",at(g))}else l=n.insert("circle",":first-child").attr("class","basic label-container").attr("style",e).attr("r",i).attr("cx",0).attr("cy",0);return T(t,l),t.calcIntersect=function(f,p){let u=f.width/2;return N.circle(f,u,p)},t.intersect=function(f){return Q.info("Circle intersect",t,i,f),N.circle(t,i,f)},n})}k(we,"circle");function ss(o){let t=Math.cos(Math.PI/4),r=Math.sin(Math.PI/4),s=o*2,e={x:s/2*t,y:s/2*r},n={x:-(s/2)*t,y:s/2*r},h={x:-(s/2)*t,y:-(s/2)*r},a={x:s/2*t,y:-(s/2)*r};return`M ${n.x},${n.y} L ${a.x},${a.y}
                   M ${e.x},${e.y} L ${h.x},${h.y}`}k(ss,"createLine");function as(o,t){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r,t.label="";let e=o.insert("g").attr("class",_(t)).attr("id",t.domId??t.id),n=Math.max(30,t?.width??0),{cssStyles:h}=t,a=S.svg(e),c=L(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let i=a.circle(0,0,n*2,c),l=ss(n),g=a.path(l,c),f=e.insert(()=>i,":first-child");return f.insert(()=>g),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),T(t,f),t.intersect=function(p){return Q.info("crossedCircle intersect",t,{radius:n,point:p}),N.circle(t,n,p)},e}k(as,"crossedCircle");function ht(o,t,r,s=100,e=0,n=180){let h=[],a=e*Math.PI/180,l=(n*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}k(ht,"generateCirclePoints");function rs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),i=Math.max(5,c*.1),{cssStyles:l}=t,g=[...ht(a/2,-c/2,i,30,-90,0),{x:-a/2-i,y:i},...ht(a/2+i*2,-i,i,20,-180,-270),...ht(a/2+i*2,i,i,20,-90,-180),{x:-a/2-i,y:-c/2},...ht(a/2,c/2,i,20,0,90)],f=[{x:a/2,y:-c/2-i},{x:-a/2,y:-c/2-i},...ht(a/2,-c/2,i,20,-90,0),{x:-a/2-i,y:-i},...ht(a/2+a*.1,-i,i,20,-180,-270),...ht(a/2+a*.1,i,i,20,-90,-180),{x:-a/2-i,y:c/2},...ht(a/2,c/2,i,20,0,90),{x:-a/2,y:c/2+i},{x:a/2,y:c/2+i}],p=S.svg(e),u=L(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(g).replace("Z",""),d=p.path(m,u),x=Z(f),b=p.path(x,st({},u)),w=e.insert("g",":first-child");return w.insert(()=>b,":first-child").attr("stroke-opacity",0),w.insert(()=>d,":first-child"),w.attr("class","text"),l&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(${i}, 0)`),h.attr("transform",`translate(${-a/2+i-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),T(t,w),t.intersect=function($){return N.polygon(t,f,$)},e})}k(rs,"curlyBraceLeft");function gt(o,t,r,s=100,e=0,n=180){let h=[],a=e*Math.PI/180,l=(n*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:p,y:u})}return h}k(gt,"generateCirclePoints");function ns(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),i=Math.max(5,c*.1),{cssStyles:l}=t,g=[...gt(a/2,-c/2,i,20,-90,0),{x:a/2+i,y:-i},...gt(a/2+i*2,-i,i,20,-180,-270),...gt(a/2+i*2,i,i,20,-90,-180),{x:a/2+i,y:c/2},...gt(a/2,c/2,i,20,0,90)],f=[{x:-a/2,y:-c/2-i},{x:a/2,y:-c/2-i},...gt(a/2,-c/2,i,20,-90,0),{x:a/2+i,y:-i},...gt(a/2+i*2,-i,i,20,-180,-270),...gt(a/2+i*2,i,i,20,-90,-180),{x:a/2+i,y:c/2},...gt(a/2,c/2,i,20,0,90),{x:a/2,y:c/2+i},{x:-a/2,y:c/2+i}],p=S.svg(e),u=L(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(g).replace("Z",""),d=p.path(m,u),x=Z(f),b=p.path(x,st({},u)),w=e.insert("g",":first-child");return w.insert(()=>b,":first-child").attr("stroke-opacity",0),w.insert(()=>d,":first-child"),w.attr("class","text"),l&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(${-i}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),T(t,w),t.intersect=function($){return N.polygon(t,f,$)},e})}k(ns,"curlyBraceRight");function et(o,t,r,s=100,e=0,n=180){let h=[],a=e*Math.PI/180,l=(n*Math.PI/180-a)/(s-1);for(let g=0;g<s;g++){let f=a+g*l,p=o+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-p,y:-u})}return h}k(et,"generateCirclePoints");function is(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),i=Math.max(5,c*.1),{cssStyles:l}=t,g=[...et(a/2,-c/2,i,30,-90,0),{x:-a/2-i,y:i},...et(a/2+i*2,-i,i,20,-180,-270),...et(a/2+i*2,i,i,20,-90,-180),{x:-a/2-i,y:-c/2},...et(a/2,c/2,i,20,0,90)],f=[...et(-a/2+i+i/2,-c/2,i,20,-90,-180),{x:a/2-i/2,y:i},...et(-a/2-i/2,-i,i,20,0,90),...et(-a/2-i/2,i,i,20,-90,0),{x:a/2-i/2,y:-i},...et(-a/2+i+i/2,c/2,i,30,-180,-270)],p=[{x:a/2,y:-c/2-i},{x:-a/2,y:-c/2-i},...et(a/2,-c/2,i,20,-90,0),{x:-a/2-i,y:-i},...et(a/2+i*2,-i,i,20,-180,-270),...et(a/2+i*2,i,i,20,-90,-180),{x:-a/2-i,y:c/2},...et(a/2,c/2,i,20,0,90),{x:-a/2,y:c/2+i},{x:a/2-i-i/2,y:c/2+i},...et(-a/2+i+i/2,-c/2,i,20,-90,-180),{x:a/2-i/2,y:i},...et(-a/2-i/2,-i,i,20,0,90),...et(-a/2-i/2,i,i,20,-90,0),{x:a/2-i/2,y:-i},...et(-a/2+i+i/2,c/2,i,30,-180,-270)],u=S.svg(e),y=L(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=Z(g).replace("Z",""),x=u.path(d,y),w=Z(f).replace("Z",""),$=u.path(w,y),M=Z(p),D=u.path(M,st({},y)),v=e.insert("g",":first-child");return v.insert(()=>D,":first-child").attr("stroke-opacity",0),v.insert(()=>x,":first-child"),v.insert(()=>$,":first-child"),v.attr("class","text"),l&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",l),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),v.attr("transform",`translate(${i-i/4}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),T(t,v),t.intersect=function(P){return N.polygon(t,p,P)},e})}k(is,"curlyBraces");function ls(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=80,a=20,c=Math.max(h,(n.width+(t.padding??0)*2)*1.25,t?.width??0),i=Math.max(a,n.height+(t.padding??0)*2,t?.height??0),l=i/2,{cssStyles:g}=t,f=S.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=c,y=i,m=u-l,d=y/4,x=[{x:m,y:0},{x:d,y:0},{x:0,y:y/2},{x:d,y},{x:m,y},...Tt(-m,-y/2,l,50,270,90)],b=Z(x),w=f.path(b,p),$=e.insert(()=>w,":first-child");return $.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&$.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&$.selectChildren("path").attr("style",s),$.attr("transform",`translate(${-c/2}, ${-i/2})`),T(t,$),t.intersect=function(M){return N.polygon(t,x,M)},e})}k(ls,"curvedTrapezoid");var Ca=k((o,t,r,s,e,n)=>[`M${o},${t+n}`,`a${e},${n} 0,0,0 ${r},0`,`a${e},${n} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${n} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createCylinderPathD"),Na=k((o,t,r,s,e,n)=>[`M${o},${t+n}`,`M${o+r},${t+n}`,`a${e},${n} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${n} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createOuterCylinderPathD"),Ra=k((o,t,r,s,e,n)=>[`M${o-r/2},${-s/2}`,`a${e},${n} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function cs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+t.padding,t.width??0),c=a/2,i=c/(2.5+a/50),l=Math.max(n.height+i+t.padding,t.height??0),g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=S.svg(e),u=Na(0,0,a,l,c,i),y=Ra(0,i,a,l,c,i),m=p.path(u,L(t,{})),d=p.path(y,L(t,{fill:"none"}));g=e.insert(()=>d,":first-child"),g=e.insert(()=>m,":first-child"),g.attr("class","basic label-container"),f&&g.attr("style",f)}else{let p=Ca(0,0,a,l,c,i);g=e.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",at(f)).attr("style",s)}return g.attr("label-offset-y",i),g.attr("transform",`translate(${-a/2}, ${-(l/2+i)})`),T(t,g),h.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+(t.padding??0)/1.5-(n.y-(n.top??0))})`),t.intersect=function(p){let u=N.rect(t,p),y=u.x-(t.x??0);if(c!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-i)){let m=i*i*(1-y*y/(c*c));m>0&&(m=Math.sqrt(m)),m=i-m,p.y-(t.y??0)>0&&(m=-m),u.y+=m}return u},e})}k(cs,"cylinder");function os(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=n.width+t.padding,c=n.height+t.padding,i=c*.2,l=-a/2,g=-c/2-i/2,{cssStyles:f}=t,p=S.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g+i},{x:-l,y:g+i},{x:-l,y:-g},{x:l,y:-g},{x:l,y:g},{x:-l,y:g},{x:-l,y:g+i}],m=p.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${l+(t.padding??0)/2-(n.x-(n.left??0))}, ${g+i+(t.padding??0)/2-(n.y-(n.top??0))})`),T(t,d),t.intersect=function(x){return N.rect(t,x)},e})}k(os,"dividedRectangle");function hs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,halfPadding:h}=yield q(o,t,_(t)),c=n.width/2+h+5,i=n.width/2+h,l,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=S.svg(e),p=L(t,{roughness:.2,strokeWidth:2.5}),u=L(t,{roughness:.2,strokeWidth:1.5}),y=f.circle(0,0,c*2,p),m=f.circle(0,0,i*2,u);l=e.insert("g",":first-child"),l.attr("class",at(t.cssClasses)).attr("style",at(g)),l.node()?.appendChild(y),l.node()?.appendChild(m)}else{l=e.insert("g",":first-child");let f=l.insert("circle",":first-child"),p=l.insert("circle");l.attr("class","basic label-container").attr("style",s),f.attr("class","outer-circle").attr("style",s).attr("r",c).attr("cx",0).attr("cy",0),p.attr("class","inner-circle").attr("style",s).attr("r",i).attr("cx",0).attr("cy",0)}return T(t,l),t.intersect=function(f){return Q.info("DoubleCircle intersect",t,c,f),N.circle(t,c,f)},e})}k(hs,"doublecircle");function gs(o,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=W(t);t.label="",t.labelStyle=s;let n=o.insert("g").attr("class",_(t)).attr("id",t.domId??t.id),h=7,{cssStyles:a}=t,c=S.svg(n),{nodeBorder:i}=r,l=L(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(l.roughness=0);let g=c.circle(0,0,h*2,l),f=n.insert(()=>g,":first-child");return f.selectAll("path").attr("style",`fill: ${i} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),e&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),T(t,f),t.intersect=function(p){return Q.info("filledCircle intersect",t,{radius:h,point:p}),N.circle(t,h,p)},n}k(gs,"filledCircle");function ps(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=n.width+(t.padding??0),c=a+n.height,i=a+n.height,l=[{x:0,y:-c},{x:i,y:-c},{x:i/2,y:0}],{cssStyles:g}=t,f=S.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=Z(l),y=f.path(u,p),m=e.insert(()=>y,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return g&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),t.width=a,t.height=c,T(t,m),h.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${-c/2+(t.padding??0)/2+(n.y-(n.top??0))})`),t.intersect=function(d){return Q.info("Triangle intersect",t,l,d),N.polygon(t,l,d)},e})}k(ps,"flippedTriangle");function fs(o,t,{dir:r,config:{state:s,themeVariables:e}}){let{nodeStyles:n}=W(t);t.label="";let h=o.insert("g").attr("class",_(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,c=Math.max(70,t?.width??0),i=Math.max(10,t?.height??0);r==="LR"&&(c=Math.max(10,t?.width??0),i=Math.max(70,t?.height??0));let l=-1*c/2,g=-1*i/2,f=S.svg(h),p=L(t,{stroke:e.lineColor,fill:e.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=f.rectangle(l,g,c,i,p),y=h.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),n&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",n),T(t,y);let m=s?.padding??0;return t.width&&t.height&&(t.width+=m/2||0,t.height+=m/2||0),t.intersect=function(d){return N.rect(t,d)},h}k(fs,"forkJoin");function us(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e=80,n=50,{shapeSvg:h,bbox:a}=yield q(o,t,_(t)),c=Math.max(e,a.width+(t.padding??0)*2,t?.width??0),i=Math.max(n,a.height+(t.padding??0)*2,t?.height??0),l=i/2,{cssStyles:g}=t,f=S.svg(h),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-c/2,y:-i/2},{x:c/2-l,y:-i/2},...Tt(-c/2+l,0,l,50,90,270),{x:c/2-l,y:i/2},{x:-c/2,y:i/2}],y=Z(u),m=f.path(y,p),d=h.insert(()=>m,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),T(t,d),t.intersect=function(x){return Q.info("Pill intersect",t,{radius:l,point:x}),N.polygon(t,u,x)},h})}k(us,"halfRoundedRectangle");function ys(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.height+(t.padding??0),a=n.width+(t.padding??0)*2.5,{cssStyles:c}=t,i=S.svg(e),l=L(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let g=a/2,f=g/6;g=g+f;let p=h/2,u=p/2,y=g-u,m=[{x:-y,y:-p},{x:0,y:-p},{x:y,y:-p},{x:g,y:0},{x:y,y:p},{x:0,y:p},{x:-y,y:p},{x:-g,y:0}],d=Z(m),x=i.path(d,l),b=e.insert(()=>x,":first-child");return b.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&b.selectChildren("path").attr("style",c),s&&t.look!=="handDrawn"&&b.selectChildren("path").attr("style",s),t.width=a,t.height=h,T(t,b),t.intersect=function(w){return N.polygon(t,m,w)},e})}k(ys,"hexagon");function ds(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.label="",t.labelStyle=r;let{shapeSvg:e}=yield q(o,t,_(t)),n=Math.max(30,t?.width??0),h=Math.max(30,t?.height??0),{cssStyles:a}=t,c=S.svg(e),i=L(t,{});t.look!=="handDrawn"&&(i.roughness=0,i.fillStyle="solid");let l=[{x:0,y:0},{x:n,y:0},{x:0,y:h},{x:n,y:h}],g=Z(l),f=c.path(g,i),p=e.insert(()=>f,":first-child");return p.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",a),s&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",s),p.attr("transform",`translate(${-n/2}, ${-h/2})`),T(t,p),t.intersect=function(u){return Q.info("Pill intersect",t,{points:l}),N.polygon(t,l,u)},e})}k(ds,"hourglass");function ms(e,n,h){return C(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let c=t.assetHeight??48,i=t.assetWidth??48,l=Math.max(c,i),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,label:u}=yield q(o,t,"icon-shape default"),y=t.pos==="t",m=l,d=l,{nodeBorder:x}=r,{stylesMap:b}=Dt(t),w=-d/2,$=-m/2,M=t.label?8:0,D=S.svg(f),v=L(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");let P=D.rectangle(w,$,d,m,v),R=Math.max(d,p.width),O=m+p.height+M,V=D.rectangle(-R/2,-O/2,R,O,lt(st({},v),{fill:"transparent",stroke:"none"})),E=f.insert(()=>P,":first-child"),B=f.insert(()=>V);if(t.icon){let I=f.append("g");I.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let A=I.node().getBBox(),X=A.width,j=A.height,H=A.x,F=A.y;I.attr("transform",`translate(${-X/2-H},${y?p.height/2+M/2-j/2-F:-p.height/2-M/2-j/2-F})`),I.attr("style",`color: ${b.get("stroke")??x};`)}return u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${y?-O/2:O/2-p.height})`),E.attr("transform",`translate(0,${y?p.height/2+M/2:-p.height/2-M/2})`),T(t,B),t.intersect=function(I){if(Q.info("iconSquare intersect",t,I),!t.label)return N.rect(t,I);let A=t.x??0,X=t.y??0,j=t.height??0,H=[];return y?H=[{x:A-p.width/2,y:X-j/2},{x:A+p.width/2,y:X-j/2},{x:A+p.width/2,y:X-j/2+p.height+M},{x:A+d/2,y:X-j/2+p.height+M},{x:A+d/2,y:X+j/2},{x:A-d/2,y:X+j/2},{x:A-d/2,y:X-j/2+p.height+M},{x:A-p.width/2,y:X-j/2+p.height+M}]:H=[{x:A-d/2,y:X-j/2},{x:A+d/2,y:X-j/2},{x:A+d/2,y:X-j/2+m},{x:A+p.width/2,y:X-j/2+m},{x:A+p.width/2/2,y:X+j/2},{x:A-p.width/2,y:X+j/2},{x:A-p.width/2,y:X-j/2+m},{x:A-d/2,y:X-j/2+m}],N.polygon(t,H,I)},f})}k(ms,"icon");function xs(e,n,h){return C(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let c=t.assetHeight??48,i=t.assetWidth??48,l=Math.max(c,i),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,label:u}=yield q(o,t,"icon-shape default"),y=20,m=t.label?8:0,d=t.pos==="t",{nodeBorder:x,mainBkg:b}=r,{stylesMap:w}=Dt(t),$=S.svg(f),M=L(t,{});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let D=w.get("fill");M.stroke=D??b;let v=f.append("g");t.icon&&v.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let P=v.node().getBBox(),R=P.width,O=P.height,V=P.x,E=P.y,B=Math.max(R,O)*Math.SQRT2+y*2,I=$.circle(0,0,B,M),A=Math.max(B,p.width),X=B+p.height+m,j=$.rectangle(-A/2,-X/2,A,X,lt(st({},M),{fill:"transparent",stroke:"none"})),H=f.insert(()=>I,":first-child"),F=f.insert(()=>j);return v.attr("transform",`translate(${-R/2-V},${d?p.height/2+m/2-O/2-E:-p.height/2-m/2-O/2-E})`),v.attr("style",`color: ${w.get("stroke")??x};`),u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${d?-X/2:X/2-p.height})`),H.attr("transform",`translate(0,${d?p.height/2+m/2:-p.height/2-m/2})`),T(t,F),t.intersect=function(z){return Q.info("iconSquare intersect",t,z),N.rect(t,z)},f})}k(xs,"iconCircle");function bs(e,n,h){return C(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let c=t.assetHeight??48,i=t.assetWidth??48,l=Math.max(c,i),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield q(o,t,"icon-shape default"),m=t.pos==="t",d=l+u*2,x=l+u*2,{nodeBorder:b,mainBkg:w}=r,{stylesMap:$}=Dt(t),M=-x/2,D=-d/2,v=t.label?8:0,P=S.svg(f),R=L(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");let O=$.get("fill");R.stroke=O??w;let V=P.path(dt(M,D,x,d,5),R),E=Math.max(x,p.width),B=d+p.height+v,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},R),{fill:"transparent",stroke:"none"})),A=f.insert(()=>V,":first-child").attr("class","icon-shape2"),X=f.insert(()=>I);if(t.icon){let j=f.append("g");j.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let H=j.node().getBBox(),F=H.width,z=H.height,Y=H.x,J=H.y;j.attr("transform",`translate(${-F/2-Y},${m?p.height/2+v/2-z/2-J:-p.height/2-v/2-z/2-J})`),j.attr("style",`color: ${$.get("stroke")??b};`)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${m?-B/2:B/2-p.height})`),A.attr("transform",`translate(0,${m?p.height/2+v/2:-p.height/2-v/2})`),T(t,X),t.intersect=function(j){if(Q.info("iconSquare intersect",t,j),!t.label)return N.rect(t,j);let H=t.x??0,F=t.y??0,z=t.height??0,Y=[];return m?Y=[{x:H-p.width/2,y:F-z/2},{x:H+p.width/2,y:F-z/2},{x:H+p.width/2,y:F-z/2+p.height+v},{x:H+x/2,y:F-z/2+p.height+v},{x:H+x/2,y:F+z/2},{x:H-x/2,y:F+z/2},{x:H-x/2,y:F-z/2+p.height+v},{x:H-p.width/2,y:F-z/2+p.height+v}]:Y=[{x:H-x/2,y:F-z/2},{x:H+x/2,y:F-z/2},{x:H+x/2,y:F-z/2+d},{x:H+p.width/2,y:F-z/2+d},{x:H+p.width/2/2,y:F+z/2},{x:H-p.width/2,y:F+z/2},{x:H-p.width/2,y:F-z/2+d},{x:H-x/2,y:F-z/2+d}],N.polygon(t,Y,j)},f})}k(bs,"iconRounded");function ws(e,n,h){return C(this,arguments,function*(o,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let c=t.assetHeight??48,i=t.assetWidth??48,l=Math.max(c,i),g=s?.wrappingWidth;t.width=Math.max(l,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield q(o,t,"icon-shape default"),m=t.pos==="t",d=l+u*2,x=l+u*2,{nodeBorder:b,mainBkg:w}=r,{stylesMap:$}=Dt(t),M=-x/2,D=-d/2,v=t.label?8:0,P=S.svg(f),R=L(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");let O=$.get("fill");R.stroke=O??w;let V=P.path(dt(M,D,x,d,.1),R),E=Math.max(x,p.width),B=d+p.height+v,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},R),{fill:"transparent",stroke:"none"})),A=f.insert(()=>V,":first-child"),X=f.insert(()=>I);if(t.icon){let j=f.append("g");j.html(`<g>${yield Bt(t.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);let H=j.node().getBBox(),F=H.width,z=H.height,Y=H.x,J=H.y;j.attr("transform",`translate(${-F/2-Y},${m?p.height/2+v/2-z/2-J:-p.height/2-v/2-z/2-J})`),j.attr("style",`color: ${$.get("stroke")??b};`)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${m?-B/2:B/2-p.height})`),A.attr("transform",`translate(0,${m?p.height/2+v/2:-p.height/2-v/2})`),T(t,X),t.intersect=function(j){if(Q.info("iconSquare intersect",t,j),!t.label)return N.rect(t,j);let H=t.x??0,F=t.y??0,z=t.height??0,Y=[];return m?Y=[{x:H-p.width/2,y:F-z/2},{x:H+p.width/2,y:F-z/2},{x:H+p.width/2,y:F-z/2+p.height+v},{x:H+x/2,y:F-z/2+p.height+v},{x:H+x/2,y:F+z/2},{x:H-x/2,y:F+z/2},{x:H-x/2,y:F-z/2+p.height+v},{x:H-p.width/2,y:F-z/2+p.height+v}]:Y=[{x:H-x/2,y:F-z/2},{x:H+x/2,y:F-z/2},{x:H+x/2,y:F-z/2+d},{x:H+p.width/2,y:F-z/2+d},{x:H+p.width/2/2,y:F+z/2},{x:H-p.width/2,y:F+z/2},{x:H-p.width/2,y:F-z/2+d},{x:H-x/2,y:F-z/2+d}],N.polygon(t,Y,j)},f})}k(ws,"iconSquare");function Ss(s,e,n){return C(this,arguments,function*(o,t,{config:{flowchart:r}}){let h=new Image;h.src=t?.img??"",yield h.decode();let a=Number(h.naturalWidth.toString().replace("px","")),c=Number(h.naturalHeight.toString().replace("px",""));t.imageAspectRatio=a/c;let{labelStyles:i}=W(t);t.labelStyle=i;let l=r?.wrappingWidth;t.defaultWidth=r?.wrappingWidth;let g=Math.max(t.label?l??0:0,t?.assetWidth??a),f=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:g,p=t.constraint==="on"?f/t.imageAspectRatio:t?.assetHeight??c;t.width=Math.max(f,l??0);let{shapeSvg:u,bbox:y,label:m}=yield q(o,t,"image-shape default"),d=t.pos==="t",x=-f/2,b=-p/2,w=t.label?8:0,$=S.svg(u),M=L(t,{});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let D=$.rectangle(x,b,f,p,M),v=Math.max(f,y.width),P=p+y.height+w,R=$.rectangle(-v/2,-P/2,v,P,lt(st({},M),{fill:"none",stroke:"none"})),O=u.insert(()=>D,":first-child"),V=u.insert(()=>R);if(t.img){let E=u.append("image");E.attr("href",t.img),E.attr("width",f),E.attr("height",p),E.attr("preserveAspectRatio","none"),E.attr("transform",`translate(${-f/2},${d?P/2-p:-P/2})`)}return m.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${d?-p/2-y.height/2-w/2:p/2-y.height/2+w/2})`),O.attr("transform",`translate(0,${d?y.height/2+w/2:-y.height/2-w/2})`),T(t,V),t.intersect=function(E){if(Q.info("iconSquare intersect",t,E),!t.label)return N.rect(t,E);let B=t.x??0,I=t.y??0,A=t.height??0,X=[];return d?X=[{x:B-y.width/2,y:I-A/2},{x:B+y.width/2,y:I-A/2},{x:B+y.width/2,y:I-A/2+y.height+w},{x:B+f/2,y:I-A/2+y.height+w},{x:B+f/2,y:I+A/2},{x:B-f/2,y:I+A/2},{x:B-f/2,y:I-A/2+y.height+w},{x:B-y.width/2,y:I-A/2+y.height+w}]:X=[{x:B-f/2,y:I-A/2},{x:B+f/2,y:I-A/2},{x:B+f/2,y:I-A/2+p},{x:B+y.width/2,y:I-A/2+p},{x:B+y.width/2/2,y:I+A/2},{x:B-y.width/2,y:I+A/2},{x:B-y.width/2,y:I-A/2+p},{x:B-f/2,y:I-A/2+p}],N.polygon(t,X,E)},u})}k(Ss,"imageSquare");function $s(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=Math.max(n.width+(t.padding??0)*2,t?.width??0),a=Math.max(n.height+(t.padding??0)*2,t?.height??0),c=[{x:0,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:-3*a/6,y:-a}],i,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);i=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&i.attr("style",l)}else i=mt(e,h,a,c);return s&&i.attr("style",s),t.width=h,t.height=a,T(t,i),t.intersect=function(g){return N.polygon(t,c,g)},e})}k($s,"inv_trapezoid");function Xt(o,t,r){return C(this,null,function*(){let{labelStyles:s,nodeStyles:e}=W(t);t.labelStyle=s;let{shapeSvg:n,bbox:h}=yield q(o,t,_(t)),a=Math.max(h.width+r.labelPaddingX*2,t?.width||0),c=Math.max(h.height+r.labelPaddingY*2,t?.height||0),i=-a/2,l=-c/2,g,{rx:f,ry:p}=t,{cssStyles:u}=t;if(r?.rx&&r.ry&&(f=r.rx,p=r.ry),t.look==="handDrawn"){let y=S.svg(n),m=L(t,{}),d=f||p?y.path(dt(i,l,a,c,f||0),m):y.rectangle(i,l,a,c,m);g=n.insert(()=>d,":first-child"),g.attr("class","basic label-container").attr("style",at(u))}else g=n.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",e).attr("rx",at(f)).attr("ry",at(p)).attr("x",i).attr("y",l).attr("width",a).attr("height",c);return T(t,g),t.calcIntersect=function(y,m){return N.rect(y,m)},t.intersect=function(y){return N.rect(t,y)},n})}k(Xt,"drawRect");function Ms(o,t){return C(this,null,function*(){let{shapeSvg:r,bbox:s,label:e}=yield q(o,t,"label"),n=r.insert("rect",":first-child");return n.attr("width",.1).attr("height",.1),r.attr("class","label edgeLabel"),e.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),T(t,n),t.intersect=function(c){return N.rect(t,c)},r})}k(Ms,"labelRect");function ks(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=Math.max(n.width+(t.padding??0),t?.width??0),a=Math.max(n.height+(t.padding??0),t?.height??0),c=[{x:0,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:-(3*a)/6,y:-a}],i,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);i=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&i.attr("style",l)}else i=mt(e,h,a,c);return s&&i.attr("style",s),t.width=h,t.height=a,T(t,i),t.intersect=function(g){return N.polygon(t,c,g)},e})}k(ks,"lean_left");function vs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=Math.max(n.width+(t.padding??0),t?.width??0),a=Math.max(n.height+(t.padding??0),t?.height??0),c=[{x:-3*a/6,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:0,y:-a}],i,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);i=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&i.attr("style",l)}else i=mt(e,h,a,c);return s&&i.attr("style",s),t.width=h,t.height=a,T(t,i),t.intersect=function(g){return N.polygon(t,c,g)},e})}k(vs,"lean_right");function Ds(o,t){let{labelStyles:r,nodeStyles:s}=W(t);t.label="",t.labelStyle=r;let e=o.insert("g").attr("class",_(t)).attr("id",t.domId??t.id),{cssStyles:n}=t,h=Math.max(35,t?.width??0),a=Math.max(35,t?.height??0),c=7,i=[{x:h,y:0},{x:0,y:a+c/2},{x:h-2*c,y:a+c/2},{x:0,y:2*a},{x:h,y:a-c/2},{x:2*c,y:a-c/2}],l=S.svg(e),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=Z(i),p=l.path(f,g),u=e.insert(()=>p,":first-child");return n&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",n),s&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",s),u.attr("transform",`translate(-${h/2},${-a})`),T(t,u),t.intersect=function(y){return Q.info("lightningBolt intersect",t,y),N.polygon(t,i,y)},e}k(Ds,"lightningBolt");var Aa=k((o,t,r,s,e,n,h)=>[`M${o},${t+n}`,`a${e},${n} 0,0,0 ${r},0`,`a${e},${n} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${n} 0,0,0 ${r},0`,`l0,${-s}`,`M${o},${t+n+h}`,`a${e},${n} 0,0,0 ${r},0`].join(" "),"createCylinderPathD"),La=k((o,t,r,s,e,n,h)=>[`M${o},${t+n}`,`M${o+r},${t+n}`,`a${e},${n} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${n} 0,0,0 ${r},0`,`l0,${-s}`,`M${o},${t+n+h}`,`a${e},${n} 0,0,0 ${r},0`].join(" "),"createOuterCylinderPathD"),Wa=k((o,t,r,s,e,n)=>[`M${o-r/2},${-s/2}`,`a${e},${n} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function Ps(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0),t.width??0),c=a/2,i=c/(2.5+a/50),l=Math.max(n.height+i+(t.padding??0),t.height??0),g=l*.1,f,{cssStyles:p}=t;if(t.look==="handDrawn"){let u=S.svg(e),y=La(0,0,a,l,c,i,g),m=Wa(0,i,a,l,c,i),d=L(t,{}),x=u.path(y,d),b=u.path(m,d);e.insert(()=>b,":first-child").attr("class","line"),f=e.insert(()=>x,":first-child"),f.attr("class","basic label-container"),p&&f.attr("style",p)}else{let u=Aa(0,0,a,l,c,i,g);f=e.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",at(p)).attr("style",s)}return f.attr("label-offset-y",i),f.attr("transform",`translate(${-a/2}, ${-(l/2+i)})`),T(t,f),h.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+i-(n.y-(n.top??0))})`),t.intersect=function(u){let y=N.rect(t,u),m=y.x-(t.x??0);if(c!=0&&(Math.abs(m)<(t.width??0)/2||Math.abs(m)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-i)){let d=i*i*(1-m*m/(c*c));d>0&&(d=Math.sqrt(d)),d=i-d,u.y-(t.y??0)>0&&(d=-d),y.y+=d}return y},e})}k(Ps,"linedCylinder");function Bs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=c/4,l=c+i,{cssStyles:g}=t,f=S.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:l/2},...yt(-a/2-a/2*.1,l/2,a/2+a/2*.1,l/2,i,.8),{x:a/2+a/2*.1,y:-l/2},{x:-a/2-a/2*.1,y:-l/2},{x:-a/2,y:-l/2},{x:-a/2,y:l/2*1.1},{x:-a/2,y:-l/2}],y=f.polygon(u.map(d=>[d.x,d.y]),p),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(0,${-i/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)-i/2-(n.y-(n.top??0))})`),T(t,m),t.intersect=function(d){return N.polygon(t,u,d)},e})}k(Bs,"linedWaveEdgedRect");function Cs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=S.svg(e),u=L(t,{}),y=[{x:l-i,y:g+i},{x:l-i,y:g+c+i},{x:l+a-i,y:g+c+i},{x:l+a-i,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g+c-i},{x:l+a+i,y:g+c-i},{x:l+a+i,y:g-i},{x:l+i,y:g-i},{x:l+i,y:g},{x:l,y:g},{x:l,y:g+i}],m=[{x:l,y:g+i},{x:l+a-i,y:g+i},{x:l+a-i,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g},{x:l,y:g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=p.path(d,u),b=Z(m),w=p.path(b,lt(st({},u),{fill:"none"})),$=e.insert(()=>w,":first-child");return $.insert(()=>x,":first-child"),$.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(n.width/2)-i-(n.x-(n.left??0))}, ${-(n.height/2)+i-(n.y-(n.top??0))})`),T(t,$),t.intersect=function(M){return N.polygon(t,y,M)},e})}k(Cs,"multiRect");function Ns(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=c/4,l=c+i,g=-a/2,f=-l/2,p=5,{cssStyles:u}=t,y=yt(g-p,f+l+p,g+a-p,f+l+p,i,.8),m=y?.[y.length-1],d=[{x:g-p,y:f+p},{x:g-p,y:f+l+p},...y,{x:g+a-p,y:m.y-p},{x:g+a,y:m.y-p},{x:g+a,y:m.y-2*p},{x:g+a+p,y:m.y-2*p},{x:g+a+p,y:f-p},{x:g+p,y:f-p},{x:g+p,y:f},{x:g,y:f},{x:g,y:f+p}],x=[{x:g,y:f+p},{x:g+a-p,y:f+p},{x:g+a-p,y:m.y-p},{x:g+a,y:m.y-p},{x:g+a,y:f},{x:g,y:f}],b=S.svg(e),w=L(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let $=Z(d),M=b.path($,w),D=Z(x),v=b.path(D,w),P=e.insert(()=>M,":first-child");return P.insert(()=>v),P.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",u),s&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",s),P.attr("transform",`translate(0,${-i/2})`),h.attr("transform",`translate(${-(n.width/2)-p-(n.x-(n.left??0))}, ${-(n.height/2)+p-i/2-(n.y-(n.top??0))})`),T(t,P),t.intersect=function(R){return N.polygon(t,d,R)},e})}k(Ns,"multiWaveEdgedRectangle");function Rs(s,e,n){return C(this,arguments,function*(o,t,{config:{themeVariables:r}}){let{labelStyles:h,nodeStyles:a}=W(t);t.labelStyle=h,t.useHtmlLabels||wt().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:i,bbox:l,label:g}=yield q(o,t,_(t)),f=Math.max(l.width+(t.padding??0)*2,t?.width??0),p=Math.max(l.height+(t.padding??0)*2,t?.height??0),u=-f/2,y=-p/2,{cssStyles:m}=t,d=S.svg(i),x=L(t,{fill:r.noteBkgColor,stroke:r.noteBorderColor});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");let b=d.rectangle(u,y,f,p,x),w=i.insert(()=>b,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),a&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",a),g.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-(l.height/2)-(l.y-(l.top??0))})`),T(t,w),t.intersect=function($){return N.rect(t,$)},i})}k(Rs,"note");var Ta=k((o,t,r)=>[`M${o+r/2},${t}`,`L${o+r},${t-r/2}`,`L${o+r/2},${t-r}`,`L${o},${t-r/2}`,"Z"].join(" "),"createDecisionBoxPathD");function As(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.width+t.padding,a=n.height+t.padding,c=h+a,i=.5,l=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}],g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=S.svg(e),u=L(t,{}),y=Ta(0,0,c),m=p.path(y,u);g=e.insert(()=>m,":first-child").attr("transform",`translate(${-c/2+i}, ${c/2})`),f&&g.attr("style",f)}else g=mt(e,c,c,l),g.attr("transform",`translate(${-c/2+i}, ${c/2})`);return s&&g.attr("style",s),T(t,g),t.calcIntersect=function(p,u){let y=p.width,m=[{x:y/2,y:0},{x:y,y:-y/2},{x:y/2,y:-y},{x:0,y:-y/2}],d=N.polygon(p,m,u);return{x:d.x-.5,y:d.y-.5}},t.intersect=function(p){return this.calcIntersect(t,p)},e})}k(As,"question");function Ls(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0),t?.width??0),c=Math.max(n.height+(t.padding??0),t?.height??0),i=-a/2,l=-c/2,g=l/2,f=[{x:i+g,y:l},{x:i,y:0},{x:i+g,y:-l},{x:-i,y:-l},{x:-i,y:l}],{cssStyles:p}=t,u=S.svg(e),y=L(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=Z(f),d=u.path(m,y),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),x.attr("transform",`translate(${-g/2},0)`),h.attr("transform",`translate(${-g/2-n.width/2-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),T(t,x),t.intersect=function(b){return N.polygon(t,f,b)},e})}k(Ls,"rect_left_inv_arrow");function Ws(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e;t.cssClasses?e="node "+t.cssClasses:e="node default";let n=o.insert("g").attr("class",e).attr("id",t.domId||t.id),h=n.insert("g"),a=n.insert("g").attr("class","label").attr("style",s),c=t.description,i=t.label,l=a.node().appendChild(yield me(i,t.labelStyle,!0,!0)),g={width:0,height:0};if(tt(U()?.flowchart?.htmlLabels)){let v=l.children[0],P=K(l);g=v.getBoundingClientRect(),P.attr("width",g.width),P.attr("height",g.height)}Q.info("Text 2",c);let f=c||[],p=l.getBBox(),u=a.node().appendChild(yield me(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],m=K(u);g=y.getBoundingClientRect(),m.attr("width",g.width),m.attr("height",g.height);let d=(t.padding||0)/2;K(u).attr("transform","translate( "+(g.width>p.width?0:(p.width-g.width)/2)+", "+(p.height+d+5)+")"),K(l).attr("transform","translate( "+(g.width<p.width?0:-(p.width-g.width)/2)+", 0)"),g=a.node().getBBox(),a.attr("transform","translate("+-g.width/2+", "+(-g.height/2-d+3)+")");let x=g.width+(t.padding||0),b=g.height+(t.padding||0),w=-g.width/2-d,$=-g.height/2-d,M,D;if(t.look==="handDrawn"){let v=S.svg(n),P=L(t,{}),R=v.path(dt(w,$,x,b,t.rx||0),P),O=v.line(-g.width/2-d,-g.height/2-d+p.height+d,g.width/2+d,-g.height/2-d+p.height+d,P);D=n.insert(()=>(Q.debug("Rough node insert CXC",R),O),":first-child"),M=n.insert(()=>(Q.debug("Rough node insert CXC",R),R),":first-child")}else M=h.insert("rect",":first-child"),D=h.insert("line"),M.attr("class","outer title-state").attr("style",s).attr("x",-g.width/2-d).attr("y",-g.height/2-d).attr("width",g.width+(t.padding||0)).attr("height",g.height+(t.padding||0)),D.attr("class","divider").attr("x1",-g.width/2-d).attr("x2",g.width/2+d).attr("y1",-g.height/2-d+p.height+d).attr("y2",-g.height/2-d+p.height+d);return T(t,M),t.intersect=function(v){return N.rect(t,v)},n})}k(Ws,"rectWithTitle");function Lt(o,t,r,s,e,n,h){let c=(o+r)/2,i=(t+s)/2,l=Math.atan2(s-t,r-o),g=(r-o)/2,f=(s-t)/2,p=g/e,u=f/n,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=c+m*n*Math.sin(l)*(h?-1:1),x=i-m*e*Math.cos(l)*(h?-1:1),b=Math.atan2((t-x)/n,(o-d)/e),$=Math.atan2((s-x)/n,(r-d)/e)-b;h&&$<0&&($+=2*Math.PI),!h&&$>0&&($-=2*Math.PI);let M=[];for(let D=0;D<20;D++){let v=D/19,P=b+v*$,R=d+e*Math.cos(P),O=x+n*Math.sin(P);M.push({x:R,y:O})}return M}k(Lt,"generateArcPoints");function Ts(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=t?.padding??0,a=t?.padding??0,c=(t?.width?t?.width:n.width)+h*2,i=(t?.height?t?.height:n.height)+a*2,l=t.radius||5,g=t.taper||5,{cssStyles:f}=t,p=S.svg(e),u=L(t,{});t.stroke&&(u.stroke=t.stroke),t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:-c/2+g,y:-i/2},{x:c/2-g,y:-i/2},...Lt(c/2-g,-i/2,c/2,-i/2+g,l,l,!0),{x:c/2,y:-i/2+g},{x:c/2,y:i/2-g},...Lt(c/2,i/2-g,c/2-g,i/2,l,l,!0),{x:c/2-g,y:i/2},{x:-c/2+g,y:i/2},...Lt(-c/2+g,i/2,-c/2,i/2-g,l,l,!0),{x:-c/2,y:i/2-g},{x:-c/2,y:-i/2+g},...Lt(-c/2,-i/2+g,-c/2+g,-i/2,l,l,!0)],m=Z(y),d=p.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container outer-path"),f&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",s),T(t,x),t.intersect=function(b){return N.polygon(t,y,b)},e})}k(Ts,"roundedRect");function Hs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=t?.padding??0,c=Math.max(n.width+(t.padding??0)*2,t?.width??0),i=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=-n.width/2-a,g=-n.height/2-a,{cssStyles:f}=t,p=S.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:l,y:g},{x:l+c+8,y:g},{x:l+c+8,y:g+i},{x:l-8,y:g+i},{x:l-8,y:g},{x:l,y:g},{x:l,y:g+i}],m=p.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container").attr("style",at(f)),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${-c/2+4+(t.padding??0)-(n.x-(n.left??0))},${-i/2+(t.padding??0)-(n.y-(n.top??0))})`),T(t,d),t.intersect=function(x){return N.rect(t,x)},e})}k(Hs,"shadedProcess");function Is(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=-a/2,l=-c/2,{cssStyles:g}=t,f=S.svg(e),p=L(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:i,y:l},{x:i,y:l+c},{x:i+a,y:l+c},{x:i+a,y:l-c/2}],y=Z(u),m=f.path(y,p),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),d.attr("transform",`translate(0, ${c/4})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))}, ${-c/4+(t.padding??0)-(n.y-(n.top??0))})`),T(t,d),t.intersect=function(x){return N.polygon(t,u,x)},e})}k(Is,"slopedRect");function Es(o,t){return C(this,null,function*(){let r={rx:0,ry:0,classes:"",labelPaddingX:t.labelPaddingX??(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return Xt(o,t,r)})}k(Es,"squareRect");function Os(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.height+t.padding,a=n.width+h/4+t.padding,c=h/2,{cssStyles:i}=t,l=S.svg(e),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=[{x:-a/2+c,y:-h/2},{x:a/2-c,y:-h/2},...Tt(-a/2+c,0,c,50,90,270),{x:a/2-c,y:h/2},...Tt(a/2-c,0,c,50,270,450)],p=Z(f),u=l.path(p,g),y=e.insert(()=>u,":first-child");return y.attr("class","basic label-container outer-path"),i&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",i),s&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",s),T(t,y),t.intersect=function(m){return N.polygon(t,f,m)},e})}k(Os,"stadium");function _s(o,t){return C(this,null,function*(){return Xt(o,t,{rx:5,ry:5,classes:"flowchart-node"})})}k(_s,"state");function zs(o,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=W(t);t.labelStyle=s;let{cssStyles:n}=t,{lineColor:h,stateBorder:a,nodeBorder:c}=r,i=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),l=S.svg(i),g=L(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=l.circle(0,0,14,lt(st({},g),{stroke:h,strokeWidth:2})),p=a??c,u=l.circle(0,0,5,lt(st({},g),{fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"})),y=i.insert(()=>f,":first-child");return y.insert(()=>u),n&&y.selectAll("path").attr("style",n),e&&y.selectAll("path").attr("style",e),T(t,y),t.intersect=function(m){return N.circle(t,7,m)},i}k(zs,"stateEnd");function js(o,t,{config:{themeVariables:r}}){let{lineColor:s}=r,e=o.insert("g").attr("class","node default").attr("id",t.domId||t.id),n;if(t.look==="handDrawn"){let a=S.svg(e).circle(0,0,14,De(s));n=e.insert(()=>a),n.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else n=e.insert("circle",":first-child"),n.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return T(t,n),t.intersect=function(h){return N.circle(t,7,h)},e}k(js,"stateStart");function Gs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=(t?.padding||0)/2,a=n.width+t.padding,c=n.height+t.padding,i=-n.width/2-h,l=-n.height/2-h,g=[{x:0,y:0},{x:a,y:0},{x:a,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look==="handDrawn"){let f=S.svg(e),p=L(t,{}),u=f.rectangle(i-8,l,a+16,c,p),y=f.line(i,l,i,l+c,p),m=f.line(i+a,l,i+a,l+c,p);e.insert(()=>y,":first-child"),e.insert(()=>m,":first-child");let d=e.insert(()=>u,":first-child"),{cssStyles:x}=t;d.attr("class","basic label-container").attr("style",at(x)),T(t,d)}else{let f=mt(e,a,c,g);s&&f.attr("style",s),T(t,f)}return t.intersect=function(f){return N.polygon(t,g,f)},e})}k(Gs,"subroutine");function qs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=Math.max(n.width+(t.padding??0)*2,t?.width??0),a=Math.max(n.height+(t.padding??0)*2,t?.height??0),c=-h/2,i=-a/2,l=.2*a,g=.2*a,{cssStyles:f}=t,p=S.svg(e),u=L(t,{}),y=[{x:c-l/2,y:i},{x:c+h+l/2,y:i},{x:c+h+l/2,y:i+a},{x:c-l/2,y:i+a}],m=[{x:c+h-l/2,y:i+a},{x:c+h+l/2,y:i+a},{x:c+h+l/2,y:i+a-g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=p.path(d,u),b=Z(m),w=p.path(b,lt(st({},u),{fillStyle:"solid"})),$=e.insert(()=>w,":first-child");return $.insert(()=>x,":first-child"),$.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),T(t,$),t.intersect=function(M){return N.polygon(t,y,M)},e})}k(qs,"taggedRect");function Fs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=c/4,l=.2*a,g=.2*c,f=c+i,{cssStyles:p}=t,u=S.svg(e),y=L(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-a/2-a/2*.1,y:f/2},...yt(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,i,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],d=-a/2+a/2*.1,x=-f/2-g*.4,b=[{x:d+a-l,y:(x+c)*1.4},{x:d+a,y:x+c-g},{x:d+a,y:(x+c)*.9},...yt(d+a,(x+c)*1.3,d+a-l,(x+c)*1.5,-c*.03,.5)],w=Z(m),$=u.path(w,y),M=Z(b),D=u.path(M,lt(st({},y),{fillStyle:"solid"})),v=e.insert(()=>D,":first-child");return v.insert(()=>$,":first-child"),v.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),v.attr("transform",`translate(0,${-i/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))},${-c/2+(t.padding??0)-i/2-(n.y-(n.top??0))})`),T(t,v),t.intersect=function(P){return N.polygon(t,m,P)},e})}k(Fs,"taggedWaveEdgedRectangle");function Xs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=Math.max(n.width+t.padding,t?.width||0),a=Math.max(n.height+t.padding,t?.height||0),c=-h/2,i=-a/2,l=e.insert("rect",":first-child");return l.attr("class","text").attr("style",s).attr("rx",0).attr("ry",0).attr("x",c).attr("y",i).attr("width",h).attr("height",a),T(t,l),t.intersect=function(g){return N.rect(t,g)},e})}k(Xs,"text");var Ha=k((o,t,r,s,e,n)=>`M${o},${t}
    a${e},${n} 0,0,1 0,${-s}
    l${r},0
    a${e},${n} 0,0,1 0,${s}
    M${r},${-s}
    a${e},${n} 0,0,0 0,${s}
    l${-r},0`,"createCylinderPathD"),Ia=k((o,t,r,s,e,n)=>[`M${o},${t}`,`M${o+r},${t}`,`a${e},${n} 0,0,0 0,${-s}`,`l${-r},0`,`a${e},${n} 0,0,0 0,${s}`,`l${r},0`].join(" "),"createOuterCylinderPathD"),Ea=k((o,t,r,s,e,n)=>[`M${o+r/2},${-s/2}`,`a${e},${n} 0,0,0 0,${s}`].join(" "),"createInnerCylinderPathD");function Ys(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h,halfPadding:a}=yield q(o,t,_(t)),c=t.look==="neo"?a*2:a,i=n.height+c,l=i/2,g=l/(2.5+i/50),f=n.width+g+c,{cssStyles:p}=t,u;if(t.look==="handDrawn"){let y=S.svg(e),m=Ia(0,0,f,i,g,l),d=Ea(0,0,f,i,g,l),x=y.path(m,L(t,{})),b=y.path(d,L(t,{fill:"none"}));u=e.insert(()=>b,":first-child"),u=e.insert(()=>x,":first-child"),u.attr("class","basic label-container"),p&&u.attr("style",p)}else{let y=Ha(0,0,f,i,g,l);u=e.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",at(p)).attr("style",s),u.attr("class","basic label-container"),p&&u.selectAll("path").attr("style",p),s&&u.selectAll("path").attr("style",s)}return u.attr("label-offset-x",g),u.attr("transform",`translate(${-f/2}, ${i/2} )`),h.attr("transform",`translate(${-(n.width/2)-g-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),T(t,u),t.intersect=function(y){let m=N.rect(t,y),d=m.y-(t.y??0);if(l!=0&&(Math.abs(d)<(t.height??0)/2||Math.abs(d)==(t.height??0)/2&&Math.abs(m.x-(t.x??0))>(t.width??0)/2-g)){let x=g*g*(1-d*d/(l*l));x!=0&&(x=Math.sqrt(Math.abs(x))),x=g-x,y.x-(t.x??0)>0&&(x=-x),m.x+=x}return m},e})}k(Ys,"tiltedCylinder");function Vs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=n.width+t.padding,a=n.height+t.padding,c=[{x:-3*a/6,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:0,y:-a}],i,{cssStyles:l}=t;if(t.look==="handDrawn"){let g=S.svg(e),f=L(t,{}),p=Z(c),u=g.path(p,f);i=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),l&&i.attr("style",l)}else i=mt(e,h,a,c);return s&&i.attr("style",s),t.width=h,t.height=a,T(t,i),t.intersect=function(g){return N.polygon(t,c,g)},e})}k(Vs,"trapezoid");function Zs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=60,a=20,c=Math.max(h,n.width+(t.padding??0)*2,t?.width??0),i=Math.max(a,n.height+(t.padding??0)*2,t?.height??0),{cssStyles:l}=t,g=S.svg(e),f=L(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let p=[{x:-c/2*.8,y:-i/2},{x:c/2*.8,y:-i/2},{x:c/2,y:-i/2*.6},{x:c/2,y:i/2},{x:-c/2,y:i/2},{x:-c/2,y:-i/2*.6}],u=Z(p),y=g.path(u,f),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),l&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",l),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),T(t,m),t.intersect=function(d){return N.polygon(t,p,d)},e})}k(Zs,"trapezoidalPentagon");function Qs(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=tt(U().flowchart?.htmlLabels),c=n.width+(t.padding??0),i=c+n.height,l=c+n.height,g=[{x:0,y:0},{x:l,y:0},{x:l/2,y:-i}],{cssStyles:f}=t,p=S.svg(e),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=Z(g),m=p.path(y,u),d=e.insert(()=>m,":first-child").attr("transform",`translate(${-i/2}, ${i/2})`);return f&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),t.width=c,t.height=i,T(t,d),h.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${i/2-(n.height+(t.padding??0)/(a?2:1)-(n.y-(n.top??0)))})`),t.intersect=function(x){return Q.info("Triangle intersect",t,g,x),N.polygon(t,g,x)},e})}k(Qs,"triangle");function Js(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=c/8,l=c+i,{cssStyles:g}=t,p=70-a,u=p>0?p/2:0,y=S.svg(e),m=L(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let d=[{x:-a/2-u,y:l/2},...yt(-a/2-u,l/2,a/2+u,l/2,i,.8),{x:a/2+u,y:-l/2},{x:-a/2-u,y:-l/2}],x=Z(d),b=y.path(x,m),w=e.insert(()=>b,":first-child");return w.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",s),w.attr("transform",`translate(0,${-i/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))},${-c/2+(t.padding??0)-i-(n.y-(n.top??0))})`),T(t,w),t.intersect=function($){return N.polygon(t,d,$)},e})}k(Js,"waveEdgedRectangle");function Ks(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n}=yield q(o,t,_(t)),h=100,a=50,c=Math.max(n.width+(t.padding??0)*2,t?.width??0),i=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=c/i,g=c,f=i;g>f*l?f=g/l:g=f*l,g=Math.max(g,h),f=Math.max(f,a);let p=Math.min(f*.2,f/4),u=f+p*2,{cssStyles:y}=t,m=S.svg(e),d=L(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=[{x:-g/2,y:u/2},...yt(-g/2,u/2,g/2,u/2,p,1),{x:g/2,y:-u/2},...yt(g/2,-u/2,-g/2,-u/2,p,-1)],b=Z(x),w=m.path(b,d),$=e.insert(()=>w,":first-child");return $.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",y),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),T(t,$),t.intersect=function(M){return N.polygon(t,x,M)},e})}k(Ks,"waveRectangle");function Us(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,label:h}=yield q(o,t,_(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),i=5,l=-a/2,g=-c/2,{cssStyles:f}=t,p=S.svg(e),u=L(t,{}),y=[{x:l-i,y:g-i},{x:l-i,y:g+c},{x:l+a,y:g+c},{x:l+a,y:g-i}],m=`M${l-i},${g-i} L${l+a},${g-i} L${l+a},${g+c} L${l-i},${g+c} L${l-i},${g-i}
                M${l-i},${g} L${l+a},${g}
                M${l},${g-i} L${l},${g+c}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=p.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("transform",`translate(${i/2}, ${i/2})`),x.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(n.width/2)+i/2-(n.x-(n.left??0))}, ${-(n.height/2)+i/2-(n.y-(n.top??0))})`),T(t,x),t.intersect=function(b){return N.polygon(t,y,b)},e})}k(Us,"windowPane");function Se(o,t){return C(this,null,function*(){let r=t;if(r.alias&&(t.label=r.alias),t.look==="handDrawn"){let{themeVariables:Y}=wt(),{background:J}=Y,rt=lt(st({},t),{id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${J}`]});yield Se(o,rt)}let s=wt();t.useHtmlLabels=s.htmlLabels;let e=s.er?.diagramPadding??10,n=s.er?.entityPadding??6,{cssStyles:h}=t,{labelStyles:a,nodeStyles:c}=W(t);if(r.attributes.length===0&&t.label){let Y={rx:0,ry:0,labelPaddingX:e,labelPaddingY:e*1.5,classes:""};Pt(t.label,s)+Y.labelPaddingX*2<s.er.minEntityWidth&&(t.width=s.er.minEntityWidth);let J=yield Xt(o,t,Y);if(!tt(s.htmlLabels)){let rt=J.select("text"),it=rt.node()?.getBBox();rt.attr("transform",`translate(${-it.width/2}, 0)`)}return J}s.htmlLabels||(e*=1.25,n*=1.25);let i=_(t);i||(i="node default");let l=o.insert("g").attr("class",i).attr("id",t.domId||t.id),g=yield kt(l,t.label??"",s,0,0,["name"],a);g.height+=n;let f=0,p=[],u=[],y=0,m=0,d=0,x=0,b=!0,w=!0;for(let Y of r.attributes){let J=yield kt(l,Y.type,s,0,f,["attribute-type"],a);y=Math.max(y,J.width+e);let rt=yield kt(l,Y.name,s,0,f,["attribute-name"],a);m=Math.max(m,rt.width+e);let it=yield kt(l,Y.keys.join(),s,0,f,["attribute-keys"],a);d=Math.max(d,it.width+e);let xt=yield kt(l,Y.comment,s,0,f,["attribute-comment"],a);x=Math.max(x,xt.width+e);let pt=Math.max(J.height,rt.height,it.height,xt.height)+n;u.push({yOffset:f,rowHeight:pt}),f+=pt}let $=4;d<=e&&(b=!1,d=0,$--),x<=e&&(w=!1,x=0,$--);let M=l.node().getBBox();if(g.width+e*2-(y+m+d+x)>0){let Y=g.width+e*2-(y+m+d+x);y+=Y/$,m+=Y/$,d>0&&(d+=Y/$),x>0&&(x+=Y/$)}let D=y+m+d+x,v=S.svg(l),P=L(t,{});t.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");let R=0;u.length>0&&(R=u.reduce((Y,J)=>Y+(J?.rowHeight??0),0));let O=Math.max(M.width+e*2,t?.width||0,D),V=Math.max((R??0)+g.height,t?.height||0),E=-O/2,B=-V/2;l.selectAll("g:not(:first-child)").each((Y,J,rt)=>{let it=K(rt[J]),xt=it.attr("transform"),pt=0,$e=0;if(xt){let Vt=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(xt);Vt&&(pt=parseFloat(Vt[1]),$e=parseFloat(Vt[2]),it.attr("class").includes("attribute-name")?pt+=y:it.attr("class").includes("attribute-keys")?pt+=y+m:it.attr("class").includes("attribute-comment")&&(pt+=y+m+d))}it.attr("transform",`translate(${E+e/2+pt}, ${$e+B+g.height+n/2})`)}),l.select(".name").attr("transform","translate("+-g.width/2+", "+(B+n/2)+")");let I=v.rectangle(E,B,O,V,P),A=l.insert(()=>I,":first-child").attr("style",h.join("")),{themeVariables:X}=wt(),{rowEven:j,rowOdd:H,nodeBorder:F}=X;p.push(0);for(let[Y,J]of u.entries()){let it=(Y+1)%2===0&&J.yOffset!==0,xt=v.rectangle(E,g.height+B+J?.yOffset,O,J?.rowHeight,lt(st({},P),{fill:it?j:H,stroke:F}));l.insert(()=>xt,"g.label").attr("style",h.join("")).attr("class",`row-rect-${it?"even":"odd"}`)}let z=v.line(E,g.height+B,O+E,g.height+B,P);l.insert(()=>z).attr("class","divider"),z=v.line(y+E,g.height+B,y+E,V+B,P),l.insert(()=>z).attr("class","divider"),b&&(z=v.line(y+m+E,g.height+B,y+m+E,V+B,P),l.insert(()=>z).attr("class","divider")),w&&(z=v.line(y+m+d+E,g.height+B,y+m+d+E,V+B,P),l.insert(()=>z).attr("class","divider"));for(let Y of p)z=v.line(E,g.height+B+Y,O+E,g.height+B+Y,P),l.insert(()=>z).attr("class","divider");if(T(t,A),c&&t.look!=="handDrawn"){let J=c.split(";")?.filter(rt=>rt.includes("stroke"))?.map(rt=>`${rt}`).join("; ");l.selectAll("path").attr("style",J??""),l.selectAll(".row-rect-even path").attr("style",c)}return t.intersect=function(Y){return N.rect(t,Y)},l})}k(Se,"erBox");function kt(a,c,i){return C(this,arguments,function*(o,t,r,s=0,e=0,n=[],h=""){let l=o.insert("g").attr("class",`label ${n.join(" ")}`).attr("transform",`translate(${s}, ${e})`).attr("style",h);t!==Zt(t)&&(t=Zt(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));let g=l.node().appendChild(yield ft(l,t,{width:Pt(t,r)+100,style:h,useHtmlLabels:r.htmlLabels},r));if(t.includes("&lt;")||t.includes("&gt;")){let p=g.children[0];for(p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");p.childNodes[0];)p=p.childNodes[0],p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let f=g.getBBox();if(tt(r.htmlLabels)){let p=g.children[0];p.style.textAlign="start";let u=K(g);f=p.getBoundingClientRect(),u.attr("width",f.width),u.attr("height",f.height)}return f})}k(kt,"addText");function ta(n,h,a,c){return C(this,arguments,function*(o,t,r,s,e=r.class.padding??12){let i=s?0:3,l=o.insert("g").attr("class",_(t)).attr("id",t.domId||t.id),g=null,f=null,p=null,u=null,y=0,m=0,d=0;if(g=l.insert("g").attr("class","annotation-group text"),t.annotations.length>0){let M=t.annotations[0];yield Wt(g,{text:`\xAB${M}\xBB`},0),y=g.node().getBBox().height}f=l.insert("g").attr("class","label-group text"),yield Wt(f,t,0,["font-weight: bolder"]);let x=f.node().getBBox();m=x.height,p=l.insert("g").attr("class","members-group text");let b=0;for(let M of t.members){let D=yield Wt(p,M,b,[M.parseClassifier()]);b+=D+i}d=p.node().getBBox().height,d<=0&&(d=e/2),u=l.insert("g").attr("class","methods-group text");let w=0;for(let M of t.methods){let D=yield Wt(u,M,w,[M.parseClassifier()]);w+=D+i}let $=l.node().getBBox();if(g!==null){let M=g.node().getBBox();g.attr("transform",`translate(${-M.width/2})`)}return f.attr("transform",`translate(${-x.width/2}, ${y})`),$=l.node().getBBox(),p.attr("transform",`translate(0, ${y+m+e*2})`),$=l.node().getBBox(),u.attr("transform",`translate(0, ${y+m+(d?d+e*4:e*2)})`),$=l.node().getBBox(),{shapeSvg:l,bbox:$}})}k(ta,"textHelper");function Wt(e,n,h){return C(this,arguments,function*(o,t,r,s=[]){let a=o.insert("g").attr("class","label").attr("style",s.join("; ")),c=wt(),i="useHtmlLabels"in t?t.useHtmlLabels:tt(c.htmlLabels)??!0,l="";"text"in t?l=t.text:l=t.label,!i&&l.startsWith("\\")&&(l=l.substring(1)),Qt(l)&&(i=!0);let g=yield ft(a,Jt(St(l)),{width:Pt(l,c)+50,classes:"markdown-node-label",useHtmlLabels:i},c),f,p=1;if(i){let u=g.children[0],y=K(g);p=u.innerHTML.split("<br>").length,u.innerHTML.includes("</math>")&&(p+=u.innerHTML.split("<mrow>").length-1);let m=u.getElementsByTagName("img");if(m){let d=l.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...m].map(x=>new Promise(b=>{function w(){if(x.style.display="flex",x.style.flexDirection="column",d){let $=c.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,D=parseInt($,10)*5+"px";x.style.minWidth=D,x.style.maxWidth=D}else x.style.width="100%";b(x)}k(w,"setupImage"),setTimeout(()=>{x.complete&&w()}),x.addEventListener("error",w),x.addEventListener("load",w)})))}f=u.getBoundingClientRect(),y.attr("width",f.width),y.attr("height",f.height)}else{s.includes("font-weight: bolder")&&K(g).selectAll("tspan").attr("font-weight",""),p=g.children.length;let u=g.children[0];(g.textContent===""||g.textContent.includes("&gt"))&&(u.textContent=l[0]+l.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),l[1]===" "&&(u.textContent=u.textContent[0]+" "+u.textContent.substring(1))),u.textContent==="undefined"&&(u.textContent=""),f=g.getBBox()}return a.attr("transform","translate(0,"+(-f.height/(2*p)+r)+")"),f.height})}k(Wt,"addText");function ea(o,t){return C(this,null,function*(){let r=U(),s=r.class.padding??12,e=s,n=t.useHtmlLabels??tt(r.htmlLabels)??!0,h=t;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];let{shapeSvg:a,bbox:c}=yield ta(o,t,r,n,e),{labelStyles:i,nodeStyles:l}=W(t);t.labelStyle=i,t.cssStyles=h.styles||"";let g=h.styles?.join(";")||l||"";t.cssStyles||(t.cssStyles=g.replaceAll("!important","").split(";"));let f=h.members.length===0&&h.methods.length===0&&!r.class?.hideEmptyMembersBox,p=S.svg(a),u=L(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=c.width,m=c.height;h.members.length===0&&h.methods.length===0?m+=e:h.members.length>0&&h.methods.length===0&&(m+=e*2);let d=-y/2,x=-m/2,b=p.rectangle(d-s,x-s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0),y+2*s,m+2*s+(f?s*2:h.members.length===0&&h.methods.length===0?-s:0),u),w=a.insert(()=>b,":first-child");w.attr("class","basic label-container");let $=w.node().getBBox();a.selectAll(".text").each((P,R,O)=>{let V=K(O[R]),E=V.attr("transform"),B=0;if(E){let j=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(E);j&&(B=parseFloat(j[2]))}let I=B+x+s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0);n||(I-=4);let A=d;(V.attr("class").includes("label-group")||V.attr("class").includes("annotation-group"))&&(A=-V.node()?.getBBox().width/2||0,a.selectAll("text").each(function(X,j,H){window.getComputedStyle(H[j]).textAnchor==="middle"&&(A=0)})),V.attr("transform",`translate(${A}, ${I})`)});let M=a.select(".annotation-group").node().getBBox().height-(f?s/2:0)||0,D=a.select(".label-group").node().getBBox().height-(f?s/2:0)||0,v=a.select(".members-group").node().getBBox().height-(f?s/2:0)||0;if(h.members.length>0||h.methods.length>0||f){let P=p.line($.x,M+D+x+s,$.x+$.width,M+D+x+s,u);a.insert(()=>P).attr("class","divider").attr("style",g)}if(f||h.members.length>0||h.methods.length>0){let P=p.line($.x,M+D+v+x+e*2+s,$.x+$.width,M+D+v+x+s+e*2,u);a.insert(()=>P).attr("class","divider").attr("style",g)}if(h.look!=="handDrawn"&&a.selectAll("path").attr("style",g),w.select(":nth-child(2)").attr("style",g),a.selectAll(".divider").select("path").attr("style",g),t.labelStyle?a.selectAll("span").attr("style",t.labelStyle):a.selectAll("span").attr("style",g),!n){let P=RegExp(/color\s*:\s*([^;]*)/),R=P.exec(g);if(R){let O=R[0].replace("color","fill");a.selectAll("tspan").attr("style",O)}else if(i){let O=P.exec(i);if(O){let V=O[0].replace("color","fill");a.selectAll("tspan").attr("style",V)}}}return T(t,w),t.intersect=function(P){return N.rect(t,P)},a})}k(ea,"classBox");function sa(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e=t,n=t,h=20,a=20,c="verifyMethod"in t,i=_(t),l=o.insert("g").attr("class",i).attr("id",t.domId??t.id),g;c?g=yield ot(l,`&lt;&lt;${e.type}&gt;&gt;`,0,t.labelStyle):g=yield ot(l,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let f=g,p=yield ot(l,e.name,f,t.labelStyle+"; font-weight: bold;");if(f+=p+a,c){let M=yield ot(l,`${e.requirementId?`ID: ${e.requirementId}`:""}`,f,t.labelStyle);f+=M;let D=yield ot(l,`${e.text?`Text: ${e.text}`:""}`,f,t.labelStyle);f+=D;let v=yield ot(l,`${e.risk?`Risk: ${e.risk}`:""}`,f,t.labelStyle);f+=v,yield ot(l,`${e.verifyMethod?`Verification: ${e.verifyMethod}`:""}`,f,t.labelStyle)}else{let M=yield ot(l,`${n.type?`Type: ${n.type}`:""}`,f,t.labelStyle);f+=M,yield ot(l,`${n.docRef?`Doc Ref: ${n.docRef}`:""}`,f,t.labelStyle)}let u=(l.node()?.getBBox().width??200)+h,y=(l.node()?.getBBox().height??200)+h,m=-u/2,d=-y/2,x=S.svg(l),b=L(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let w=x.rectangle(m,d,u,y,b),$=l.insert(()=>w,":first-child");if($.attr("class","basic label-container").attr("style",s),l.selectAll(".label").each((M,D,v)=>{let P=K(v[D]),R=P.attr("transform"),O=0,V=0;if(R){let A=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(R);A&&(O=parseFloat(A[1]),V=parseFloat(A[2]))}let E=V-y/2,B=m+h/2;(D===0||D===1)&&(B=O),P.attr("transform",`translate(${B}, ${E+h})`)}),f>g+p+a){let M=x.line(m,d+g+p+a,m+u,d+g+p+a,b);l.insert(()=>M).attr("style",s)}return T(t,$),t.intersect=function(M){return N.rect(t,M)},l})}k(sa,"requirementBox");function ot(o,t,r,s=""){return C(this,null,function*(){if(t==="")return 0;let e=o.insert("g").attr("class","label").attr("style",s),n=U(),h=n.htmlLabels??!0,a=yield ft(e,Jt(St(t)),{width:Pt(t,n)+50,classes:"markdown-node-label",useHtmlLabels:h,style:s},n),c;if(h){let i=a.children[0],l=K(a);c=i.getBoundingClientRect(),l.attr("width",c.width),l.attr("height",c.height)}else{let i=a.children[0];for(let l of i.children)l.textContent=l.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),s&&l.setAttribute("style",s);c=a.getBBox(),c.height+=6}return e.attr("transform",`translate(${-c.width/2},${-c.height/2+r})`),c.height})}k(ot,"addText");var Oa=k(o=>{switch(o){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");function aa(s,e,n){return C(this,arguments,function*(o,t,{config:r}){let{labelStyles:h,nodeStyles:a}=W(t);t.labelStyle=h||"";let c=10,i=t.width;t.width=(t.width??200)-10;let{shapeSvg:l,bbox:g,label:f}=yield q(o,t,_(t)),p=t.padding||10,u="",y;"ticket"in t&&t.ticket&&r?.kanban?.ticketBaseUrl&&(u=r?.kanban?.ticketBaseUrl.replace("#TICKET#",t.ticket),y=l.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",u).attr("target","_blank"));let m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},d,x;y?{label:d,bbox:x}=yield de(y,"ticket"in t&&t.ticket||"",m):{label:d,bbox:x}=yield de(l,"ticket"in t&&t.ticket||"",m);let{label:b,bbox:w}=yield de(l,"assigned"in t&&t.assigned||"",m);t.width=i;let $=10,M=t?.width||0,D=Math.max(x.height,w.height)/2,v=Math.max(g.height+$*2,t?.height||0)+D,P=-M/2,R=-v/2;f.attr("transform","translate("+(p-M/2)+", "+(-D-g.height/2)+")"),d.attr("transform","translate("+(p-M/2)+", "+(-D+g.height/2)+")"),b.attr("transform","translate("+(p+M/2-w.width-2*c)+", "+(-D+g.height/2)+")");let O,{rx:V,ry:E}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){let I=S.svg(l),A=L(t,{}),X=V||E?I.path(dt(P,R,M,v,V||0),A):I.rectangle(P,R,M,v,A);O=l.insert(()=>X,":first-child"),O.attr("class","basic label-container").attr("style",B||null)}else{O=l.insert("rect",":first-child"),O.attr("class","basic label-container __APA__").attr("style",a).attr("rx",V??5).attr("ry",E??5).attr("x",P).attr("y",R).attr("width",M).attr("height",v);let I="priority"in t&&t.priority;if(I){let A=l.append("line"),X=P+2,j=R+Math.floor((V??0)/2),H=R+v-Math.floor((V??0)/2);A.attr("x1",X).attr("y1",j).attr("x2",X).attr("y2",H).attr("stroke-width","4").attr("stroke",Oa(I))}}return T(t,O),t.height=v,t.intersect=function(I){return N.rect(t,I)},l})}k(aa,"kanbanItem");function ra(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,halfPadding:h,label:a}=yield q(o,t,_(t)),c=n.width+10*h,i=n.height+8*h,l=.15*c,{cssStyles:g}=t,f=n.width+20,p=n.height+20,u=Math.max(c,f),y=Math.max(i,p);a.attr("transform",`translate(${-n.width/2}, ${-n.height/2})`);let m,d=`M0 0 
    a${l},${l} 1 0,0 ${u*.25},${-1*y*.1}
    a${l},${l} 1 0,0 ${u*.25},0
    a${l},${l} 1 0,0 ${u*.25},0
    a${l},${l} 1 0,0 ${u*.25},${y*.1}

    a${l},${l} 1 0,0 ${u*.15},${y*.33}
    a${l*.8},${l*.8} 1 0,0 0,${y*.34}
    a${l},${l} 1 0,0 ${-1*u*.15},${y*.33}

    a${l},${l} 1 0,0 ${-1*u*.25},${y*.15}
    a${l},${l} 1 0,0 ${-1*u*.25},0
    a${l},${l} 1 0,0 ${-1*u*.25},0
    a${l},${l} 1 0,0 ${-1*u*.25},${-1*y*.15}

    a${l},${l} 1 0,0 ${-1*u*.1},${-1*y*.33}
    a${l*.8},${l*.8} 1 0,0 0,${-1*y*.34}
    a${l},${l} 1 0,0 ${u*.1},${-1*y*.33}
  H0 V0 Z`;if(t.look==="handDrawn"){let x=S.svg(e),b=L(t,{}),w=x.path(d,b);m=e.insert(()=>w,":first-child"),m.attr("class","basic label-container").attr("style",at(g))}else m=e.insert("path",":first-child").attr("class","basic label-container").attr("style",s).attr("d",d);return m.attr("transform",`translate(${-u/2}, ${-y/2})`),T(t,m),t.calcIntersect=function(x,b){return N.rect(x,b)},t.intersect=function(x){return Q.info("Bang intersect",t,x),N.rect(t,x)},e})}k(ra,"bang");function na(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,halfPadding:h,label:a}=yield q(o,t,_(t)),c=n.width+2*h,i=n.height+2*h,l=.15*c,g=.25*c,f=.35*c,p=.2*c,{cssStyles:u}=t,y,m=`M0 0 
    a${l},${l} 0 0,1 ${c*.25},${-1*c*.1}
    a${f},${f} 1 0,1 ${c*.4},${-1*c*.1}
    a${g},${g} 1 0,1 ${c*.35},${c*.2}

    a${l},${l} 1 0,1 ${c*.15},${i*.35}
    a${p},${p} 1 0,1 ${-1*c*.15},${i*.65}

    a${g},${l} 1 0,1 ${-1*c*.25},${c*.15}
    a${f},${f} 1 0,1 ${-1*c*.5},0
    a${l},${l} 1 0,1 ${-1*c*.25},${-1*c*.15}

    a${l},${l} 1 0,1 ${-1*c*.1},${-1*i*.35}
    a${p},${p} 1 0,1 ${c*.1},${-1*i*.65}
  H0 V0 Z`;if(t.look==="handDrawn"){let d=S.svg(e),x=L(t,{}),b=d.path(m,x);y=e.insert(()=>b,":first-child"),y.attr("class","basic label-container").attr("style",at(u))}else y=e.insert("path",":first-child").attr("class","basic label-container").attr("style",s).attr("d",m);return a.attr("transform",`translate(${-n.width/2}, ${-n.height/2})`),y.attr("transform",`translate(${-c/2}, ${-i/2})`),T(t,y),t.calcIntersect=function(d,x){return N.rect(d,x)},t.intersect=function(d){return Q.info("Cloud intersect",t,d),N.rect(t,d)},e})}k(na,"cloud");function ia(o,t){return C(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:n,halfPadding:h,label:a}=yield q(o,t,_(t)),c=n.width+8*h,i=n.height+2*h,l=5,g=`
    M${-c/2} ${i/2-l}
    v${-i+2*l}
    q0,-${l} ${l},-${l}
    h${c-2*l}
    q${l},0 ${l},${l}
    v${i-2*l}
    q0,${l} -${l},${l}
    h${-c+2*l}
    q-${l},0 -${l},-${l}
    Z
  `,f=e.append("path").attr("id","node-"+t.id).attr("class","node-bkg node-"+t.type).attr("style",s).attr("d",g);return e.append("line").attr("class","node-line-").attr("x1",-c/2).attr("y1",i/2).attr("x2",c/2).attr("y2",i/2),a.attr("transform",`translate(${-n.width/2}, ${-n.height/2})`),e.append(()=>a.node()),T(t,f),t.calcIntersect=function(p,u){return N.rect(p,u)},t.intersect=function(p){return N.rect(t,p)},e})}k(ia,"defaultMindmapNode");function la(o,t){return C(this,null,function*(){let r={padding:t.padding??0};return we(o,t,r)})}k(la,"mindmapCircle");var _a=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Es},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ts},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Os},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Gs},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:cs},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:we},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:ra},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:na},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:As},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:ys},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:vs},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:ks},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Vs},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:$s},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:hs},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Xs},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:ts},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Hs},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:js},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:zs},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:fs},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:ds},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:rs},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:ns},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:is},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Ds},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Js},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:us},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Ys},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Ps},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ls},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:os},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Qs},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Us},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:gs},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Zs},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ps},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Is},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Ns},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Cs},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Ue},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:as},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Fs},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:qs},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Ks},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Ls},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Bs}],za=k(()=>{let t=[...Object.entries({state:_s,choice:es,note:Rs,rectWithTitle:Ws,labelRect:Ms,iconSquare:ws,iconCircle:xs,icon:ms,iconRounded:bs,imageSquare:Ss,anchor:Ke,kanbanItem:aa,mindmapCircle:la,defaultMindmapNode:ia,classBox:ea,erBox:Se,requirementBox:sa}),..._a.flatMap(r=>[r.shortName,..."aliases"in r?r.aliases:[],..."internalAliases"in r?r.internalAliases:[]].map(e=>[e,r.handler]))];return Object.fromEntries(t)},"generateShapeMap"),ca=za();function ja(o){return o in ca}k(ja,"isValidShape");var Yt=new Map;function Ga(o,t,r){return C(this,null,function*(){let s,e;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");let n=t.shape?ca[t.shape]:void 0;if(!n)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let h;r.config.securityLevel==="sandbox"?h="_top":t.linkTarget&&(h=t.linkTarget||"_blank"),s=o.insert("svg:a").attr("xlink:href",t.link).attr("target",h??null),e=yield n(s,t,r)}else e=yield n(o,t,r),s=e;return t.tooltip&&e.attr("title",t.tooltip),Yt.set(t.id,s),t.haveCallback&&s.attr("class",s.attr("class")+" clickable"),s})}k(Ga,"insertNode");var yn=k((o,t)=>{Yt.set(t.id,o)},"setNodeElem"),dn=k(()=>{Yt.clear()},"clear"),mn=k(o=>{let t=Yt.get(o.id);Q.trace("Transforming node",o.diff,o,"translate("+(o.x-o.width/2-5)+", "+o.width/2+")");let r=8,s=o.diff||0;return o.clusterNode?t.attr("transform","translate("+(o.x+s-o.width/2)+", "+(o.y-o.height/2-r)+")"):t.attr("transform","translate("+o.x+", "+o.y+")"),s},"positionNode");export{S as a,q as b,T as c,me as d,sr as e,ar as f,ja as g,Ga as h,yn as i,dn as j,mn as k};
