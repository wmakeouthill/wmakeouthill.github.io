<div class="chat-widget-container" [class.scroll-top-visible]="scrollToTopVisible()">
  <app-chat-floating-button [isOpen]="isOpen()" (onClick)="toggleOpen()" />

  @if (isOpen()) {
    <section class="chat-panel" aria-label="Chat com IA sobre o Wesley">
      <app-chat-header (onClose)="toggleOpen()" />

      <div class="chat-messages" role="log" #messagesContainer>
        @if (messages().length === 0) {
          <app-chat-message [message]="initialMessage" />
        }

        @for (message of messages(); track message.timestamp) {
          <app-chat-message [message]="message" />
        }

        @if (isLoading()) {
          <app-chat-loading />
        }
      </div>

      <app-chat-input
        [isLoading]="isLoading()"
        [inputText]="inputText()"
        [canSend]="canSend()"
        [shouldFocus]="isOpen()"
        (onInputChange)="handleInputChange($event)"
        (onSend)="sendMessage()"
      />
    </section>
  }
</div>


